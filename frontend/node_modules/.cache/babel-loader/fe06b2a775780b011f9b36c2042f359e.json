{"ast":null,"code":"import React,{useContext,useEffect,useRef,useState}from\"react\";import MenuItem from\"@material-ui/core/MenuItem\";import Menu from\"@material-ui/core/Menu\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import ConfirmationModal from\"../ConfirmationModal\";import TransferTicketModalCustom from\"../TransferTicketModalCustom\";import toastError from\"../../errors/toastError\";import{Can}from\"../Can\";import{AuthContext}from\"../../context/Auth/AuthContext\";import ScheduleModal from\"../ScheduleModal\";const TicketOptionsMenu=_ref=>{let{ticket,menuOpen,handleClose,anchorEl}=_ref;const[confirmationOpen,setConfirmationOpen]=useState(false);const[transferTicketModalOpen,setTransferTicketModalOpen]=useState(false);const isMounted=useRef(true);const{user}=useContext(AuthContext);const[scheduleModalOpen,setScheduleModalOpen]=useState(false);const[contactId,setContactId]=useState(null);useEffect(()=>{return()=>{isMounted.current=false;};},[]);const handleDeleteTicket=async()=>{try{await api.delete(`/tickets/${ticket.id}`);}catch(err){toastError(err);}};const handleOpenConfirmationModal=e=>{setConfirmationOpen(true);handleClose();};const handleOpenTransferModal=e=>{setTransferTicketModalOpen(true);handleClose();};const handleCloseTransferTicketModal=()=>{if(isMounted.current){setTransferTicketModalOpen(false);}};const handleOpenScheduleModal=()=>{handleClose();setContactId(ticket.contact.id);setScheduleModalOpen(true);};const handleCloseScheduleModal=()=>{setScheduleModalOpen(false);setContactId(null);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Menu,{id:\"menu-appbar\",anchorEl:anchorEl,getContentAnchorEl:null,anchorOrigin:{vertical:\"bottom\",horizontal:\"right\"},keepMounted:true,transformOrigin:{vertical:\"top\",horizontal:\"right\"},open:menuOpen,onClose:handleClose},/*#__PURE__*/React.createElement(MenuItem,{onClick:handleOpenScheduleModal},i18n.t(\"ticketOptionsMenu.schedule\")),/*#__PURE__*/React.createElement(MenuItem,{onClick:handleOpenTransferModal},i18n.t(\"ticketOptionsMenu.transfer\")),/*#__PURE__*/React.createElement(Can,{role:user.profile,perform:\"ticket-options:deleteTicket\",yes:()=>/*#__PURE__*/React.createElement(MenuItem,{onClick:handleOpenConfirmationModal},i18n.t(\"ticketOptionsMenu.delete\"))})),/*#__PURE__*/React.createElement(ConfirmationModal,{title:`${i18n.t(\"ticketOptionsMenu.confirmationModal.title\")}${ticket.id} ${i18n.t(\"ticketOptionsMenu.confirmationModal.titleFrom\")} ${ticket.contact.name}?`,open:confirmationOpen,onClose:setConfirmationOpen,onConfirm:handleDeleteTicket},i18n.t(\"ticketOptionsMenu.confirmationModal.message\")),/*#__PURE__*/React.createElement(TransferTicketModalCustom,{modalOpen:transferTicketModalOpen,onClose:handleCloseTransferTicketModal,ticketid:ticket.id}),/*#__PURE__*/React.createElement(ScheduleModal,{open:scheduleModalOpen,onClose:handleCloseScheduleModal,\"aria-labelledby\":\"form-dialog-title\",contactId:contactId,ticketId:ticket.id}));};export default TicketOptionsMenu;","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import { useRef, useEffect, useCallback } from 'react';\n\n/**\r\n * Hook personalizado para manejar el foco en modales\r\n * Evita problemas de aria-hidden y asegura accesibilidad correcta\r\n */\nconst useModalFocus = open => {\n  const modalRef = useRef(null);\n  const previousActiveElement = useRef(null);\n\n  // Guardar el elemento activo antes de abrir el modal\n  useEffect(() => {\n    if (open) {\n      previousActiveElement.current = document.activeElement;\n    }\n  }, [open]);\n\n  // Restaurar el foco al cerrar el modal\n  const handleClose = useCallback(() => {\n    // Asegurar que el foco se libere del modal inmediatamente\n    if (modalRef.current) {\n      const activeElement = modalRef.current.querySelector(':focus');\n      if (activeElement) {\n        activeElement.blur();\n      }\n    }\n\n    // También liberar cualquier foco activo en el documento\n    if (document.activeElement && document.activeElement.blur) {\n      document.activeElement.blur();\n    }\n\n    // Pequeño delay para asegurar que el foco se libere completamente\n    setTimeout(() => {\n      // Restaurar el foco al elemento anterior si existe y es válido\n      if (previousActiveElement.current && previousActiveElement.current.focus && document.contains(previousActiveElement.current) && !previousActiveElement.current.hasAttribute('aria-hidden')) {\n        previousActiveElement.current.focus();\n      } else {\n        // Si no hay elemento anterior válido, liberar el foco completamente\n        if (document.activeElement && document.activeElement.blur) {\n          document.activeElement.blur();\n        }\n        // También asegurar que el body no tenga foco\n        document.body.focus();\n        document.body.blur();\n      }\n    }, 10);\n  }, []);\n\n  // Manejar el evento onExited del Dialog\n  const handleExited = useCallback(() => {\n    // Asegurar que el foco se libere completamente al cerrar\n    if (document.activeElement && document.activeElement.blur) {\n      document.activeElement.blur();\n    }\n\n    // Forzar la liberación del foco del body\n    document.body.focus();\n    document.body.blur();\n\n    // Limpiar la referencia del elemento anterior\n    previousActiveElement.current = null;\n  }, []);\n  return {\n    modalRef,\n    handleClose,\n    handleExited\n  };\n};\nexport default useModalFocus;","map":{"version":3,"names":["useRef","useEffect","useCallback","useModalFocus","open","modalRef","previousActiveElement","current","document","activeElement","handleClose","querySelector","blur","setTimeout","focus","contains","hasAttribute","body","handleExited"],"sources":["C:/laragon/www/whaticket03/waticketsaas/frontend/src/hooks/useModalFocus.js"],"sourcesContent":["import { useRef, useEffect, useCallback } from 'react';\r\n\r\n/**\r\n * Hook personalizado para manejar el foco en modales\r\n * Evita problemas de aria-hidden y asegura accesibilidad correcta\r\n */\r\nconst useModalFocus = (open) => {\r\n  const modalRef = useRef(null);\r\n  const previousActiveElement = useRef(null);\r\n\r\n  // Guardar el elemento activo antes de abrir el modal\r\n  useEffect(() => {\r\n    if (open) {\r\n      previousActiveElement.current = document.activeElement;\r\n    }\r\n  }, [open]);\r\n\r\n  // Restaurar el foco al cerrar el modal\r\n  const handleClose = useCallback(() => {\r\n    // Asegurar que el foco se libere del modal inmediatamente\r\n    if (modalRef.current) {\r\n      const activeElement = modalRef.current.querySelector(':focus');\r\n      if (activeElement) {\r\n        activeElement.blur();\r\n      }\r\n    }\r\n\r\n    // También liberar cualquier foco activo en el documento\r\n    if (document.activeElement && document.activeElement.blur) {\r\n      document.activeElement.blur();\r\n    }\r\n\r\n    // Pequeño delay para asegurar que el foco se libere completamente\r\n    setTimeout(() => {\r\n      // Restaurar el foco al elemento anterior si existe y es válido\r\n      if (previousActiveElement.current && \r\n          previousActiveElement.current.focus && \r\n          document.contains(previousActiveElement.current) &&\r\n          !previousActiveElement.current.hasAttribute('aria-hidden')) {\r\n        previousActiveElement.current.focus();\r\n      } else {\r\n        // Si no hay elemento anterior válido, liberar el foco completamente\r\n        if (document.activeElement && document.activeElement.blur) {\r\n          document.activeElement.blur();\r\n        }\r\n        // También asegurar que el body no tenga foco\r\n        document.body.focus();\r\n        document.body.blur();\r\n      }\r\n    }, 10);\r\n  }, []);\r\n\r\n  // Manejar el evento onExited del Dialog\r\n  const handleExited = useCallback(() => {\r\n    // Asegurar que el foco se libere completamente al cerrar\r\n    if (document.activeElement && document.activeElement.blur) {\r\n      document.activeElement.blur();\r\n    }\r\n    \r\n    // Forzar la liberación del foco del body\r\n    document.body.focus();\r\n    document.body.blur();\r\n    \r\n    // Limpiar la referencia del elemento anterior\r\n    previousActiveElement.current = null;\r\n  }, []);\r\n\r\n  return {\r\n    modalRef,\r\n    handleClose,\r\n    handleExited\r\n  };\r\n};\r\n\r\nexport default useModalFocus; "],"mappings":"AAAA,SAASA,MAAM,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;;AAEtD;AACA;AACA;AACA;AACA,MAAMC,aAAa,GAAIC,IAAI,IAAK;EAC9B,MAAMC,QAAQ,GAAGL,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAMM,qBAAqB,GAAGN,MAAM,CAAC,IAAI,CAAC;;EAE1C;EACAC,SAAS,CAAC,MAAM;IACd,IAAIG,IAAI,EAAE;MACRE,qBAAqB,CAACC,OAAO,GAAGC,QAAQ,CAACC,aAAa;IACxD;EACF,CAAC,EAAE,CAACL,IAAI,CAAC,CAAC;;EAEV;EACA,MAAMM,WAAW,GAAGR,WAAW,CAAC,MAAM;IACpC;IACA,IAAIG,QAAQ,CAACE,OAAO,EAAE;MACpB,MAAME,aAAa,GAAGJ,QAAQ,CAACE,OAAO,CAACI,aAAa,CAAC,QAAQ,CAAC;MAC9D,IAAIF,aAAa,EAAE;QACjBA,aAAa,CAACG,IAAI,CAAC,CAAC;MACtB;IACF;;IAEA;IACA,IAAIJ,QAAQ,CAACC,aAAa,IAAID,QAAQ,CAACC,aAAa,CAACG,IAAI,EAAE;MACzDJ,QAAQ,CAACC,aAAa,CAACG,IAAI,CAAC,CAAC;IAC/B;;IAEA;IACAC,UAAU,CAAC,MAAM;MACf;MACA,IAAIP,qBAAqB,CAACC,OAAO,IAC7BD,qBAAqB,CAACC,OAAO,CAACO,KAAK,IACnCN,QAAQ,CAACO,QAAQ,CAACT,qBAAqB,CAACC,OAAO,CAAC,IAChD,CAACD,qBAAqB,CAACC,OAAO,CAACS,YAAY,CAAC,aAAa,CAAC,EAAE;QAC9DV,qBAAqB,CAACC,OAAO,CAACO,KAAK,CAAC,CAAC;MACvC,CAAC,MAAM;QACL;QACA,IAAIN,QAAQ,CAACC,aAAa,IAAID,QAAQ,CAACC,aAAa,CAACG,IAAI,EAAE;UACzDJ,QAAQ,CAACC,aAAa,CAACG,IAAI,CAAC,CAAC;QAC/B;QACA;QACAJ,QAAQ,CAACS,IAAI,CAACH,KAAK,CAAC,CAAC;QACrBN,QAAQ,CAACS,IAAI,CAACL,IAAI,CAAC,CAAC;MACtB;IACF,CAAC,EAAE,EAAE,CAAC;EACR,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMM,YAAY,GAAGhB,WAAW,CAAC,MAAM;IACrC;IACA,IAAIM,QAAQ,CAACC,aAAa,IAAID,QAAQ,CAACC,aAAa,CAACG,IAAI,EAAE;MACzDJ,QAAQ,CAACC,aAAa,CAACG,IAAI,CAAC,CAAC;IAC/B;;IAEA;IACAJ,QAAQ,CAACS,IAAI,CAACH,KAAK,CAAC,CAAC;IACrBN,QAAQ,CAACS,IAAI,CAACL,IAAI,CAAC,CAAC;;IAEpB;IACAN,qBAAqB,CAACC,OAAO,GAAG,IAAI;EACtC,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IACLF,QAAQ;IACRK,WAAW;IACXQ;EACF,CAAC;AACH,CAAC;AAED,eAAef,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"/**\n * Utilidad para limpiar datos de autenticación\n * Se ejecuta automáticamente cuando se detectan errores de token\n */export const clearAuthData=()=>{try{// Limpiar todos los datos de autenticación\nlocalStorage.removeItem(\"token\");localStorage.removeItem(\"userId\");localStorage.removeItem(\"companyId\");localStorage.removeItem(\"user\");localStorage.removeItem(\"cshow\");// Limpiar cookies relacionadas\ndocument.cookie.split(\";\").forEach(c=>{document.cookie=c.replace(/^ +/,\"\").replace(/=.*/,\"=;expires=\"+new Date().toUTCString()+\";path=/\");});console.log(\"🧹 Datos de autenticación limpiados automáticamente\");// Redirigir al login\nwindow.location.href=\"/login\";}catch(error){console.error(\"Error limpiando datos de autenticación:\",error);}};/**\n * Verificar si el token es válido\n */export const isTokenValid=token=>{if(!token)return false;try{// Verificar si el token tiene el formato correcto (JWT)\nconst parts=token.split('.');if(parts.length!==3)return false;// Verificar si no está expirado (timestamp básico)\nconst payload=JSON.parse(atob(parts[1]));const currentTime=Date.now()/1000;if(payload.exp&&payload.exp<currentTime){console.log(\"⏰ Token expirado automáticamente\");return false;}return true;}catch(error){console.log(\"❌ Token inválido detectado automáticamente\");return false;}};/**\n * Verificar y limpiar automáticamente si es necesario\n */export const validateAndCleanAuth=()=>{const token=localStorage.getItem(\"token\");// Verificar si estamos en una ruta que no requiere autenticación\nconst publicRoutes=['/login','/forget-password','/signup'];const currentPath=window.location.pathname;if(publicRoutes.includes(currentPath)){return true;// Permitir acceso a rutas públicas\n}if(!token){console.log(\"🔄 No hay token - redirigiendo al login\");clearAuthData();return false;}if(!isTokenValid(token)){console.log(\"🔄 Token inválido detectado - limpieza automática\");clearAuthData();return false;}return true;};","map":null,"metadata":{},"sourceType":"module"}
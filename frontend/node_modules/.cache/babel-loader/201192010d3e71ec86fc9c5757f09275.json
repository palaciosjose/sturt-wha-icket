{"ast":null,"code":"var _jsxFileName = \"C:\\\\laragon\\\\www\\\\whaticket03\\\\waticketsaas\\\\frontend\\\\src\\\\components\\\\MessageInputCustom\\\\index.js\";\nimport React, { useState, useEffect, useContext, useRef } from \"react\";\nimport withWidth, { isWidthUp } from \"@material-ui/core/withWidth\";\nimport \"emoji-mart/css/emoji-mart.css\";\nimport { Picker } from \"emoji-mart\";\nimport MicRecorder from \"mic-recorder-to-mp3\";\nimport clsx from \"clsx\";\nimport { isNil } from \"lodash\";\nimport { Reply } from \"@material-ui/icons\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Paper from \"@material-ui/core/Paper\";\nimport InputBase from \"@material-ui/core/InputBase\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { green, grey } from \"@material-ui/core/colors\";\nimport AttachFileIcon from \"@material-ui/icons/AttachFile\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport MoodIcon from \"@material-ui/icons/Mood\";\nimport SendIcon from \"@material-ui/icons/Send\";\nimport CancelIcon from \"@material-ui/icons/Cancel\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\nimport MicIcon from \"@material-ui/icons/Mic\";\nimport CheckCircleOutlineIcon from \"@material-ui/icons/CheckCircleOutline\";\nimport HighlightOffIcon from \"@material-ui/icons/HighlightOff\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport FlashOnIcon from \"@material-ui/icons/FlashOn\";\nimport FolderIcon from \"@material-ui/icons/Folder\";\nimport { FormControlLabel, Switch, Menu, MenuItem } from \"@material-ui/core\";\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\nimport { isString, isEmpty, isObject, has } from \"lodash\";\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport axios from \"axios\";\nimport RecordingTimer from \"./RecordingTimer\";\nimport { ReplyMessageContext } from \"../../context/ReplyingMessage/ReplyingMessageContext\";\nimport { ForwardMessageContext } from \"../../context/ForwarMessage/ForwardMessageContext\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nimport { useLocalStorage } from \"../../hooks/useLocalStorage\";\nimport toastError from \"../../errors/toastError\";\nimport Compressor from 'compressorjs';\nimport LinearWithValueLabel from \"./ProgressBarCustom\";\nimport useQuickMessages from \"../../hooks/useQuickMessages\";\nimport useFiles from \"../../hooks/useFiles\";\nimport logger from \"../../utils/logger\";\nconst Mp3Recorder = new MicRecorder({\n  bitRate: 128\n});\nconst useStyles = makeStyles(theme => ({\n  mainWrapper: {\n    backgroundColor: theme.palette.bordabox,\n    //DARK MODE PLW DESIGN//\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    borderTop: \"1px solid rgba(0, 0, 0, 0.12)\"\n  },\n  newMessageBox: {\n    backgroundColor: theme.palette.newmessagebox,\n    //DARK MODE PLW DESIGN//\n    width: \"100%\",\n    display: \"flex\",\n    padding: \"7px\",\n    alignItems: \"center\"\n  },\n  messageInputWrapper: {\n    padding: 6,\n    marginRight: 7,\n    backgroundColor: theme.palette.inputdigita,\n    //DARK MODE PLW DESIGN//\n    display: \"flex\",\n    borderRadius: 20,\n    flex: 1\n  },\n  messageInput: {\n    paddingLeft: 10,\n    flex: 1,\n    border: \"none\"\n  },\n  sendMessageIcons: {\n    color: \"grey\"\n  },\n  ForwardMessageIcons: {\n    color: grey[700],\n    transform: 'scaleX(-1)'\n  },\n  uploadInput: {\n    display: \"none\"\n  },\n  viewMediaInputWrapper: {\n    display: \"flex\",\n    padding: \"10px 13px\",\n    position: \"relative\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    backgroundColor: \"#eee\",\n    borderTop: \"1px solid rgba(0, 0, 0, 0.12)\"\n  },\n  emojiBox: {\n    position: \"absolute\",\n    bottom: 63,\n    width: 40,\n    borderTop: \"1px solid #e8e8e8\"\n  },\n  circleLoading: {\n    color: green[500],\n    opacity: \"70%\",\n    position: \"absolute\",\n    top: \"20%\",\n    left: \"50%\",\n    marginLeft: -12\n  },\n  audioLoading: {\n    color: green[500],\n    opacity: \"70%\"\n  },\n  recorderWrapper: {\n    display: \"flex\",\n    alignItems: \"center\",\n    alignContent: \"middle\"\n  },\n  cancelAudioIcon: {\n    color: \"red\"\n  },\n  sendAudioIcon: {\n    color: \"green\"\n  },\n  replyginMsgWrapper: {\n    display: \"flex\",\n    width: \"100%\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingTop: 8,\n    paddingLeft: 73,\n    paddingRight: 7\n  },\n  replyginMsgContainer: {\n    flex: 1,\n    marginRight: 5,\n    overflowY: \"hidden\",\n    backgroundColor: \"rgba(0, 0, 0, 0.05)\",\n    borderRadius: \"7.5px\",\n    display: \"flex\",\n    position: \"relative\"\n  },\n  replyginMsgBody: {\n    padding: 10,\n    height: \"auto\",\n    display: \"block\",\n    whiteSpace: \"pre-wrap\",\n    overflow: \"hidden\"\n  },\n  replyginContactMsgSideColor: {\n    flex: \"none\",\n    width: \"4px\",\n    backgroundColor: \"#35cd96\"\n  },\n  replyginSelfMsgSideColor: {\n    flex: \"none\",\n    width: \"4px\",\n    backgroundColor: \"#6bcbef\"\n  },\n  messageContactName: {\n    display: \"flex\",\n    color: \"#6bcbef\",\n    fontWeight: 500\n  }\n}));\nconst EmojiOptions = props => {\n  const {\n    disabled,\n    showEmoji,\n    setShowEmoji,\n    handleAddEmoji\n  } = props;\n  const classes = useStyles();\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(IconButton, {\n    \"aria-label\": \"emojiPicker\",\n    component: \"span\",\n    disabled: disabled,\n    onClick: e => setShowEmoji(prevState => !prevState),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(MoodIcon, {\n    className: classes.sendMessageIcons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 9\n    }\n  })), showEmoji ? /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.emojiBox,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Picker, {\n    perLine: 16,\n    showPreview: false,\n    showSkinTones: false,\n    onSelect: handleAddEmoji,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 11\n    }\n  })) : null);\n};\nconst SignSwitch = props => {\n  const {\n    width,\n    setSignMessage,\n    signMessage\n  } = props;\n  if (isWidthUp(\"md\", width)) {\n    return /*#__PURE__*/React.createElement(FormControlLabel, {\n      style: {\n        marginRight: 7,\n        color: \"gray\"\n      },\n      label: i18n.t(\"messagesInput.signMessage\"),\n      labelPlacement: \"start\",\n      control: /*#__PURE__*/React.createElement(Switch, {\n        size: \"small\",\n        checked: signMessage,\n        onChange: e => {\n          setSignMessage(e.target.checked);\n        },\n        name: \"showAllTickets\",\n        color: \"primary\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 7\n      }\n    });\n  }\n  return null;\n};\nconst FileInput = props => {\n  const {\n    handleChangeMedias,\n    disableOption\n  } = props;\n  const classes = useStyles();\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"input\", {\n    multiple: true,\n    type: \"file\",\n    id: \"upload-button\",\n    disabled: disableOption(),\n    className: classes.uploadInput,\n    onChange: handleChangeMedias,\n    accept: \"image/*,video/*,audio/*,.pdf,.doc,.docx,.xls,.xlsx,.txt\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"upload-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    \"aria-label\": \"upload\",\n    component: \"span\",\n    disabled: disableOption(),\n    title: \"Adjuntar archivos (m\\xFAltiples) - NUEVO\",\n    style: {\n      backgroundColor: '#e3f2fd',\n      borderRadius: '50%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(AttachFileIcon, {\n    className: classes.sendMessageIcons,\n    style: {\n      color: '#2196f3'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 11\n    }\n  }))));\n};\nconst ActionButtons = props => {\n  const {\n    inputMessage,\n    loading,\n    recording,\n    ticketStatus,\n    handleSendMessage,\n    handleCancelAudio,\n    handleUploadAudio,\n    handleStartRecording,\n    handleOpenModalForward,\n    showSelectMessageCheckbox\n  } = props;\n  const classes = useStyles();\n\n  // âœ… FUNCIÃ“N PARA CANCELAR SELECCIÃ“N DE MENSAJES\n  const handleCancelSelection = () => {\n    const {\n      setShowSelectMessageCheckbox,\n      setSelectedMessages\n    } = props;\n    setShowSelectMessageCheckbox(false);\n    setSelectedMessages([]);\n  };\n  if (showSelectMessageCheckbox) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        gap: '8px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"cancelSelection\",\n      component: \"span\",\n      onClick: handleCancelSelection,\n      disabled: loading,\n      style: {\n        color: '#f44336'\n      },\n      title: \"Cancelar selecci\\xF3n\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(HighlightOffIcon, {\n      className: classes.sendMessageIcons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"forwardMessage\",\n      component: \"span\",\n      onClick: handleOpenModalForward,\n      disabled: loading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Reply, {\n      className: classes.ForwardMessageIcons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 11\n      }\n    })));\n  } else if (inputMessage) {\n    return /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"sendMessage\",\n      component: \"span\",\n      onClick: handleSendMessage,\n      disabled: loading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(SendIcon, {\n      className: classes.sendMessageIcons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 9\n      }\n    }));\n  } else if (recording) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.recorderWrapper,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"cancelRecording\",\n      component: \"span\",\n      fontSize: \"large\",\n      disabled: loading,\n      onClick: handleCancelAudio,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(HighlightOffIcon, {\n      className: classes.cancelAudioIcon,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 11\n      }\n    })), loading ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(CircularProgress, {\n      className: classes.audioLoading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 13\n      }\n    })) : /*#__PURE__*/React.createElement(RecordingTimer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"sendRecordedAudio\",\n      component: \"span\",\n      onClick: handleUploadAudio,\n      disabled: loading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(CheckCircleOutlineIcon, {\n      className: classes.sendAudioIcon,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 11\n      }\n    })));\n  } else {\n    return /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"showRecorder\",\n      component: \"span\",\n      disabled: loading || ticketStatus !== \"open\",\n      onClick: handleStartRecording,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(MicIcon, {\n      className: classes.sendMessageIcons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 9\n      }\n    }));\n  }\n};\nconst CustomInput = props => {\n  const {\n    loading,\n    inputRef,\n    ticketStatus,\n    inputMessage,\n    setInputMessage,\n    handleSendMessage,\n    handleInputPaste,\n    disableOption,\n    handleQuickAnswersClick,\n    options,\n    popupOpen\n  } = props;\n  const classes = useStyles();\n  const onKeyPress = e => {\n    if (loading || e.shiftKey) return;else if (e.key === \"Enter\") {\n      handleSendMessage();\n    }\n  };\n  const onPaste = e => {\n    if (ticketStatus === \"open\") {\n      handleInputPaste(e);\n    }\n  };\n  const renderPlaceholder = () => {\n    if (ticketStatus === \"open\") {\n      return i18n.t(\"messagesInput.placeholderOpen\") + \" (usa / para respuestas rÃ¡pidas)\";\n    }\n    return i18n.t(\"messagesInput.placeholderClosed\");\n  };\n  const setInputRef = input => {\n    if (input) {\n      input.focus();\n      inputRef.current = input;\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.messageInputWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Autocomplete, {\n    freeSolo: true,\n    open: popupOpen,\n    id: \"quick-messages-autocomplete\",\n    value: inputMessage,\n    options: options,\n    closeIcon: null,\n    getOptionLabel: option => {\n      if (isObject(option)) {\n        return option.label;\n      } else {\n        return option;\n      }\n    },\n    onChange: (event, opt) => {\n      if (isObject(opt) && has(opt, \"value\") && isNil(opt.mediaPath)) {\n        setInputMessage(opt.value);\n        setTimeout(() => {\n          inputRef.current.scrollTop = inputRef.current.scrollHeight;\n        }, 200);\n      } else if (isObject(opt) && has(opt, \"value\") && !isNil(opt.mediaPath)) {\n        handleQuickAnswersClick(opt);\n        setTimeout(() => {\n          inputRef.current.scrollTop = inputRef.current.scrollHeight;\n        }, 200);\n      }\n    },\n    onInputChange: (event, opt, reason) => {\n      if (reason === \"input\") {\n        setInputMessage(event.target.value);\n      }\n    },\n    onPaste: onPaste,\n    onKeyPress: onKeyPress,\n    style: {\n      width: \"100%\"\n    },\n    renderInput: params => {\n      const {\n        InputLabelProps,\n        InputProps,\n        ...rest\n      } = params;\n      return /*#__PURE__*/React.createElement(InputBase, Object.assign({}, params.InputProps, rest, {\n        disabled: disableOption(),\n        inputRef: setInputRef,\n        placeholder: renderPlaceholder(),\n        multiline: true,\n        className: classes.messageInput,\n        maxRows: 5,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 455,\n          columnNumber: 13\n        }\n      }));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 7\n    }\n  }));\n};\nconst MessageInputCustom = props => {\n  console.log(\"ðŸš€ MessageInputCustom cargado - VersiÃ³n mejorada con envÃ­o mÃºltiple - CAMBIO VISIBLE\");\n  const {\n    ticketStatus,\n    ticketId\n  } = props;\n  const classes = useStyles();\n  const [percentLoading, setPercentLoading] = useState(0);\n  const [medias, setMedias] = useState([]);\n  const [inputMessage, setInputMessage] = useState(\"\");\n  const [showEmoji, setShowEmoji] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [recording, setRecording] = useState(false);\n  const [quickMessages, setQuickMessages] = useState([]);\n  const [options, setOptions] = useState([]);\n  const [popupOpen, setPopupOpen] = useState(false);\n  const [fileLists, setFileLists] = useState([]);\n  const [fileListOptions, setFileListOptions] = useState([]);\n  const [fileListAnchorEl, setFileListAnchorEl] = useState(null);\n  const [isDragOver, setIsDragOver] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState({});\n  const inputRef = useRef();\n  const {\n    setReplyingMessage,\n    replyingMessage\n  } = useContext(ReplyMessageContext);\n  const {\n    user\n  } = useContext(AuthContext);\n  const [signMessage, setSignMessage] = useLocalStorage(\"signOption\", true);\n  const {\n    selectedMessages,\n    setForwardMessageModalOpen,\n    showSelectMessageCheckbox,\n    setShowSelectMessageCheckbox,\n    setSelectedMessages\n  } = useContext(ForwardMessageContext);\n  const {\n    list: listQuickMessages\n  } = useQuickMessages();\n  const {\n    list: listFiles\n  } = useFiles();\n\n  // Cargar respuestas rÃ¡pidas\n  useEffect(() => {\n    async function fetchData() {\n      const companyId = localStorage.getItem(\"companyId\");\n      const messages = await listQuickMessages({\n        companyId,\n        userId: user.id\n      });\n      const options = messages.map(m => {\n        let truncatedMessage = m.message;\n        if (isString(truncatedMessage) && truncatedMessage.length > 35) {\n          truncatedMessage = m.message.substring(0, 35) + \"...\";\n        }\n        return {\n          value: m.message,\n          label: `/${m.shortcode} - ${truncatedMessage}`,\n          shortcode: m.shortcode,\n          message: m.message,\n          mediaPath: m.mediaPath\n        };\n      });\n      setQuickMessages(options);\n    }\n    fetchData();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Cargar listas de archivos\n  useEffect(() => {\n    async function fetchFileLists() {\n      const companyId = localStorage.getItem(\"companyId\");\n      const files = await listFiles({\n        companyId,\n        userId: user.id\n      });\n      const options = files.map(fileList => {\n        let truncatedName = fileList.name;\n        if (isString(truncatedName) && truncatedName.length > 35) {\n          truncatedName = fileList.name.substring(0, 35) + \"...\";\n        }\n        return {\n          value: fileList,\n          label: `ðŸ“ ${truncatedName}`,\n          name: fileList.name,\n          message: fileList.message,\n          options: fileList.options\n        };\n      });\n      setFileLists(options);\n    }\n    fetchFileLists();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Manejar autocompletado de respuestas rÃ¡pidas\n  useEffect(() => {\n    if (isString(inputMessage) && !isEmpty(inputMessage) && inputMessage.startsWith(\"/\")) {\n      setPopupOpen(true);\n\n      // Si solo hay \"/\", mostrar todas las opciones\n      if (inputMessage === \"/\") {\n        setOptions(quickMessages);\n      } else {\n        // Filtrar por lo que se escriba despuÃ©s de \"/\"\n        const searchTerm = inputMessage.substring(1).toLowerCase();\n        const filteredOptions = quickMessages.filter(m => m.shortcode.toLowerCase().includes(searchTerm) || m.message.toLowerCase().includes(searchTerm));\n        setOptions(filteredOptions);\n      }\n    } else {\n      setPopupOpen(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [inputMessage]);\n  useEffect(() => {\n    inputRef.current.focus();\n  }, [replyingMessage]);\n  useEffect(() => {\n    inputRef.current.focus();\n    return () => {\n      console.log(\"ðŸ§¹ Limpiando estado al cambiar ticketId:\", ticketId);\n      setInputMessage(\"\");\n      setShowEmoji(false);\n      setMedias([]);\n      setReplyingMessage(null);\n    };\n  }, [ticketId, setReplyingMessage]);\n\n  // const handleChangeInput = e => {\n  // \tif (isObject(e) && has(e, 'value')) {\n  // \t\tsetInputMessage(e.value);\n  // \t} else {\n  // \t\tsetInputMessage(e.target.value)\n  // \t}\n  // };\n\n  const handleOpenModalForward = () => {\n    if (selectedMessages.length === 0) {\n      setForwardMessageModalOpen(false);\n      toastError(i18n.t(\"messagesList.header.notMessage\"));\n      return;\n    }\n    setForwardMessageModalOpen(true);\n  };\n  const handleAddEmoji = e => {\n    let emoji = e.native;\n    setInputMessage(prevState => prevState + emoji);\n  };\n  const handleChangeMedias = e => {\n    if (!e.target.files) {\n      return;\n    }\n    const selectedMedias = Array.from(e.target.files);\n    console.log(\"ðŸŽ¯ handleChangeMedias ejecutado - Archivos seleccionados:\", selectedMedias.length);\n\n    // âœ… MEJORA: Acumular archivos en lugar de reemplazar\n    setMedias(prevMedias => {\n      console.log(\"ðŸ“Š Estado anterior de medias:\", prevMedias.length, prevMedias.map(f => f.name));\n      const newMedias = [...prevMedias, ...selectedMedias];\n      console.log(\"ðŸ“ Archivos acumulados:\", newMedias.length, newMedias.map(f => f.name));\n      return newMedias;\n    });\n  };\n  const handleInputPaste = e => {\n    const items = e.clipboardData.items;\n    if (!items) return;\n    for (let i = 0; i < items.length; i++) {\n      const item = items[i];\n      if (item.type.indexOf('image') !== -1) {\n        const file = item.getAsFile();\n        if (file) {\n          console.log(\"ðŸ“‹ Imagen pegada:\", file.name || \"imagen_pegada\");\n          setMedias(prevMedias => [...prevMedias, file]);\n        }\n      }\n    }\n  };\n\n  // âœ… MEJORA: Drag & Drop mÃºltiple\n  const handleDragOver = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    console.log(\"ðŸŽ¯ DragOver detectado\");\n    setIsDragOver(true);\n  };\n  const handleDragEnter = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    console.log(\"ðŸŽ¯ DragEnter detectado\");\n    setIsDragOver(true);\n  };\n  const handleDragLeave = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (!e.currentTarget.contains(e.relatedTarget)) {\n      console.log(\"ðŸŽ¯ DragLeave detectado\");\n      setIsDragOver(false);\n    }\n  };\n  const handleDrop = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    console.log(\"ðŸŽ¯ Drop detectado\");\n    setIsDragOver(false);\n    const files = Array.from(e.dataTransfer.files);\n    console.log(\"ðŸ“ Archivos en drop:\", files.length, files.map(f => f.name));\n    if (files.length > 0) {\n      setMedias(prevMedias => {\n        console.log(\"ðŸ“Š Estado anterior de medias (drop):\", prevMedias.length, prevMedias.map(f => f.name));\n        const newMedias = [...prevMedias, ...files];\n        console.log(\"ðŸ–±ï¸ Archivos arrastrados:\", files.length, files.map(f => f.name));\n        console.log(\"ðŸ“ Total archivos:\", newMedias.length, newMedias.map(f => f.name));\n        return newMedias;\n      });\n    }\n  };\n\n  // âœ… MEJORA: Eliminar archivo especÃ­fico\n  const handleRemoveMedia = indexToRemove => {\n    setMedias(prevMedias => prevMedias.filter((_, index) => index !== indexToRemove));\n  };\n\n  // âœ… MEJORA: FunciÃ³n para obtener el tipo de archivo\n  const getFileType = file => {\n    if (file.type.startsWith('image/')) return 'ðŸ–¼ï¸';\n    if (file.type.startsWith('video/')) return 'ðŸŽ¥';\n    if (file.type.startsWith('audio/')) return 'ðŸŽµ';\n    if (file.type.includes('pdf')) return 'ðŸ“„';\n    if (file.type.includes('document') || file.type.includes('word')) return 'ðŸ“';\n    if (file.type.includes('sheet') || file.type.includes('excel')) return 'ðŸ“Š';\n    return 'ðŸ“Ž';\n  };\n  const handleUploadQuickMessageMedia = async (blob, originalFileName) => {\n    try {\n      if (logger && logger.media) {\n        logger.media.debug(\"Procesando multimedia para envÃ­o, tipo:\", blob.type);\n        logger.media.debug(\"Nombre original del archivo:\", originalFileName);\n      }\n\n      // Mantener el nombre original del archivo\n      let filename = originalFileName;\n\n      // Si el nombre es muy extenso (mÃ¡s de 50 caracteres), truncarlo\n      if (filename && filename.length > 50) {\n        const extension = filename.split('.').pop();\n        const nameWithoutExt = filename.substring(0, filename.lastIndexOf('.'));\n        const truncatedName = nameWithoutExt.substring(0, 47) + '...';\n        filename = `${truncatedName}.${extension}`;\n        if (logger && logger.media) {\n          logger.media.debug(\"Nombre truncado:\", filename);\n        }\n      }\n\n      // Si no hay nombre original, generar uno con timestamp\n      if (!filename) {\n        const extension = blob.type.split(\"/\")[1] || 'bin';\n        filename = `${new Date().getTime()}.${extension}`;\n        if (logger && logger.media) {\n          logger.media.debug(\"Nombre generado:\", filename);\n        }\n      }\n      if (logger && logger.media) {\n        logger.media.debug(\"Nombre final del archivo:\", filename);\n      }\n      const formData = new FormData();\n      formData.append(\"medias\", blob, filename);\n      formData.append(\"body\", filename); // Usar el nombre del archivo como body\n      formData.append(\"fromMe\", true);\n      if (logger && logger.media) {\n        logger.media.debug(\"Enviando multimedia al servidor...\");\n      }\n      await api.post(`/messages/${ticketId}`, formData);\n      if (logger && logger.media) {\n        logger.media.info(\"Multimedia enviada exitosamente\");\n      }\n    } catch (err) {\n      if (logger && logger.media) {\n        logger.media.error(\"Error al enviar multimedia:\", err);\n      }\n      toastError(err);\n      throw err; // Re-lanzar el error para que lo maneje la funciÃ³n padre\n    }\n  };\n  const handleQuickAnswersClick = async value => {\n    if (value.mediaPath) {\n      setLoading(true);\n      try {\n        if (logger && logger.media) {\n          logger.media.debug(\"Descargando multimedia desde:\", value.mediaPath);\n          logger.media.debug(\"URL completa:\", value.mediaPath);\n        }\n\n        // âœ… Validar que la URL sea vÃ¡lida\n        if (!value.mediaPath || value.mediaPath === 'null' || value.mediaPath === 'undefined' || value.mediaPath.includes('undefined')) {\n          if (logger && logger.media) {\n            logger.media.warn(\"URL de multimedia invÃ¡lida:\", value.mediaPath);\n          }\n          toastError(new Error(\"URL de multimedia invÃ¡lida - Contacte al administrador\"));\n          setLoading(false);\n          setInputMessage(value.value);\n          return;\n        }\n        const {\n          data\n        } = await axios.get(value.mediaPath, {\n          responseType: \"blob\",\n          timeout: 10000 // 10 segundos de timeout\n        });\n        if (logger && logger.media) {\n          logger.media.debug(\"Multimedia descargada exitosamente, tamaÃ±o:\", data.size);\n        }\n\n        // âœ… EXTRAER NOMBRE REAL DEL ARCHIVO DESDE LA URL\n        let fileName = value.value; // Fallback al texto de respuesta rÃ¡pida\n\n        if (value.mediaPath) {\n          // Extraer nombre desde la URL del archivo\n          const urlParts = value.mediaPath.split('/');\n          const lastPart = urlParts[urlParts.length - 1];\n          if (lastPart && lastPart.includes('.')) {\n            fileName = lastPart;\n            if (logger && logger.media) {\n              logger.media.debug(\"Nombre extraÃ­do desde URL:\", fileName);\n            }\n          }\n        }\n        await handleUploadQuickMessageMedia(data, fileName);\n        setInputMessage(\"\");\n        setLoading(false);\n        return;\n      } catch (err) {\n        console.error(\"Error al procesar multimedia de respuesta rÃ¡pida:\", err);\n        console.error(\"URL que fallÃ³:\", value.mediaPath);\n\n        // Mostrar error mÃ¡s especÃ­fico\n        let errorMessage = \"Error al procesar multimedia\";\n        if (err.response) {\n          if (err.response.status === 404) {\n            errorMessage = \"Archivo multimedia no encontrado\";\n          } else if (err.response.status === 403) {\n            errorMessage = \"Sin permisos para acceder al archivo\";\n          } else {\n            errorMessage = `Error del servidor: ${err.response.status}`;\n          }\n        } else if (err.code === 'ECONNABORTED') {\n          errorMessage = \"Tiempo de espera agotado\";\n        }\n        toastError(new Error(errorMessage));\n        setLoading(false);\n\n        // Si falla la multimedia, al menos enviar el texto\n        setInputMessage(value.value);\n        return;\n      }\n    }\n    setInputMessage(\"\");\n    setInputMessage(value.value);\n  };\n  const handleFileListClick = async value => {\n    if (logger && logger.media) {\n      logger.media.debug(\"Valor recibido en handleFileListClick:\", value);\n    }\n\n    // Verificar si value.value.options existe (estructura correcta)\n    if (!value.value || !value.value.options || value.value.options.length === 0) {\n      if (logger && logger.media) {\n        logger.media.warn(\"No hay archivos en la lista. value.value:\", value.value);\n      }\n      toastError(\"Esta lista de archivos no contiene archivos\");\n      return;\n    }\n    setLoading(true);\n    try {\n      if (logger && logger.media) {\n        logger.media.debug(\"Enviando lista de archivos:\", value.name);\n        logger.media.debug(\"Archivos en la lista:\", value.value.options.length);\n      }\n\n      // Enviar cada archivo de la lista\n      for (const fileOption of value.value.options) {\n        try {\n          if (logger && logger.media) {\n            logger.media.debug(\"Procesando archivo:\", fileOption.name);\n          }\n\n          // Construir URL del archivo\n          const publicFolder = \"public/fileList\";\n          const fileUrl = `${process.env.REACT_APP_BACKEND_URL || 'http://localhost:8080'}/${publicFolder}/${value.value.id}/${fileOption.path}`;\n          if (logger && logger.media) {\n            logger.media.debug(\"URL del archivo:\", fileUrl);\n          }\n\n          // Extraer nombre del archivo desde la ruta\n          const fileName = fileOption.path || fileOption.name || 'documento';\n          if (logger && logger.media) {\n            logger.media.debug(\"Nombre del archivo extraÃ­do:\", fileName);\n          }\n\n          // Descargar archivo\n          const {\n            data\n          } = await axios.get(fileUrl, {\n            responseType: \"blob\",\n            timeout: 10000\n          });\n          if (logger && logger.media) {\n            logger.media.debug(\"Archivo descargado:\", fileName, \"tamaÃ±o:\", data.size);\n          }\n\n          // Enviar archivo\n          await handleUploadQuickMessageMedia(data, fileName);\n\n          // PequeÃ±a pausa entre archivos para no sobrecargar\n          await new Promise(resolve => setTimeout(resolve, 500));\n        } catch (err) {\n          if (logger && logger.media) {\n            logger.media.error(\"Error procesando archivo:\", fileOption.name, err);\n          }\n          toastError(`Error al procesar archivo: ${fileOption.name}`);\n        }\n      }\n      if (logger && logger.media) {\n        logger.media.info(\"Lista de archivos enviada exitosamente\");\n      }\n      setLoading(false);\n    } catch (err) {\n      if (logger && logger.media) {\n        logger.media.error(\"Error al enviar lista de archivos:\", err);\n      }\n      toastError(\"Error al enviar lista de archivos\");\n      setLoading(false);\n    }\n  };\n  const handleUploadMedia = async e => {\n    setLoading(true);\n    e.preventDefault();\n    console.log(\"ðŸš€ Iniciando envÃ­o de\", medias.length, \"archivos\");\n    const totalFiles = medias.length;\n    let completedFiles = 0;\n    let failedFiles = 0;\n\n    // âœ… MEJORA: Enviar cada archivo por separado\n    for (let i = 0; i < medias.length; i++) {\n      const media = medias[i];\n      console.log(`ðŸ“¤ Enviando archivo ${i + 1}/${totalFiles}:`, media.name);\n      try {\n        // Actualizar progreso\n        setUploadProgress(prev => ({\n          ...prev,\n          [i]: 0\n        }));\n        if ((media === null || media === void 0 ? void 0 : media.type.split('/')[0]) === 'image') {\n          // âœ… MEJORA: Manejar compresiÃ³n de imÃ¡genes correctamente\n          await new Promise((resolve, reject) => {\n            new Compressor(media, {\n              quality: 0.7,\n              async success(compressedMedia) {\n                try {\n                  const formData = new FormData();\n                  formData.append(\"fromMe\", true);\n                  formData.append(\"medias\", compressedMedia);\n                  formData.append(\"body\", media.name);\n                  await api.post(`/messages/${ticketId}`, formData, {\n                    onUploadProgress: event => {\n                      const progress = Math.round(event.loaded * 100 / event.total);\n                      setUploadProgress(prev => ({\n                        ...prev,\n                        [i]: progress\n                      }));\n                      console.log(`ðŸ“Š ${media.name}: ${progress}%`);\n                    }\n                  });\n                  completedFiles++;\n                  console.log(`âœ… Archivo ${i + 1}/${totalFiles} enviado:`, media.name);\n                  resolve();\n                } catch (err) {\n                  console.error(`âŒ Error enviando ${media.name}:`, err);\n                  failedFiles++;\n                  reject(err);\n                }\n              },\n              error(err) {\n                console.error(`âŒ Error comprimiendo ${media.name}:`, err);\n                failedFiles++;\n                reject(err);\n              }\n            });\n          });\n        } else {\n          // âœ… MEJORA: Enviar archivos no-imagen directamente\n          const formData = new FormData();\n          formData.append(\"fromMe\", true);\n          formData.append(\"medias\", media);\n          formData.append(\"body\", media.name);\n          await api.post(`/messages/${ticketId}`, formData, {\n            onUploadProgress: event => {\n              const progress = Math.round(event.loaded * 100 / event.total);\n              setUploadProgress(prev => ({\n                ...prev,\n                [i]: progress\n              }));\n              console.log(`ðŸ“Š ${media.name}: ${progress}%`);\n            }\n          });\n          completedFiles++;\n          console.log(`âœ… Archivo ${i + 1}/${totalFiles} enviado:`, media.name);\n        }\n      } catch (err) {\n        console.error(`âŒ Error enviando archivo ${media.name}:`, err);\n        failedFiles++;\n        toastError(err);\n      }\n    }\n    setLoading(false);\n    setMedias([]);\n    setUploadProgress({});\n    console.log(`ðŸŽ‰ EnvÃ­o completado: ${completedFiles}/${totalFiles} archivos enviados, ${failedFiles} fallidos`);\n  };\n  const handleSendMessage = async () => {\n    if (inputMessage.trim() === \"\") return;\n    setLoading(true);\n    const message = {\n      read: 1,\n      fromMe: true,\n      mediaUrl: \"\",\n      body: signMessage ? `*${user === null || user === void 0 ? void 0 : user.name}:*\\n${inputMessage.trim()}` : inputMessage.trim(),\n      quotedMsg: replyingMessage\n    };\n    try {\n      await api.post(`/messages/${ticketId}`, message);\n    } catch (err) {\n      toastError(err);\n    }\n    setInputMessage(\"\");\n    setShowEmoji(false);\n    setLoading(false);\n    setReplyingMessage(null);\n  };\n  const handleStartRecording = async () => {\n    setLoading(true);\n    try {\n      await navigator.mediaDevices.getUserMedia({\n        audio: true\n      });\n      await Mp3Recorder.start();\n      setRecording(true);\n      setLoading(false);\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n  };\n  const handleUploadAudio = async () => {\n    setLoading(true);\n    try {\n      const [, blob] = await Mp3Recorder.stop().getMp3();\n      if (blob.size < 10000) {\n        setLoading(false);\n        setRecording(false);\n        return;\n      }\n      const formData = new FormData();\n      const filename = `audio-record-site-${new Date().getTime()}.mp3`;\n      formData.append(\"medias\", blob, filename);\n      formData.append(\"body\", filename);\n      formData.append(\"fromMe\", true);\n      await api.post(`/messages/${ticketId}`, formData);\n    } catch (err) {\n      toastError(err);\n    }\n    setRecording(false);\n    setLoading(false);\n  };\n  const handleCancelAudio = async () => {\n    try {\n      await Mp3Recorder.stop().getMp3();\n      setRecording(false);\n    } catch (err) {\n      toastError(err);\n    }\n  };\n  const handleQuickReplyButtonClick = () => {\n    setInputMessage(\"/\");\n    // Forzar que se muestren las opciones inmediatamente\n    setTimeout(() => {\n      setPopupOpen(true);\n      setOptions(quickMessages);\n    }, 100);\n    if (inputRef.current) {\n      inputRef.current.focus();\n    }\n  };\n  const handleFileListButtonClick = event => {\n    setFileListAnchorEl(event.currentTarget);\n    setFileListOptions(fileLists);\n  };\n  const handleFileListMenuClose = () => {\n    setFileListAnchorEl(null);\n  };\n  const handleFileListSelect = fileList => {\n    handleFileListClick(fileList);\n    handleFileListMenuClose();\n  };\n  const disableOption = () => {\n    return loading || recording || ticketStatus !== \"open\";\n  };\n  const renderReplyingMessage = message => {\n    var _message$contact;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.replyginMsgWrapper,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1129,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.replyginMsgContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1130,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: clsx(classes.replyginContactMsgSideColor, {\n        [classes.replyginSelfMsgSideColor]: !message.fromMe\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1131,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.replyginMsgBody,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1136,\n        columnNumber: 11\n      }\n    }, !message.fromMe && /*#__PURE__*/React.createElement(\"span\", {\n      className: classes.messageContactName,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1138,\n        columnNumber: 15\n      }\n    }, (_message$contact = message.contact) === null || _message$contact === void 0 ? void 0 : _message$contact.name), message.body)), /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"showRecorder\",\n      component: \"span\",\n      disabled: loading || ticketStatus !== \"open\",\n      onClick: () => setReplyingMessage(null),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1145,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ClearIcon, {\n      className: classes.sendMessageIcons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1151,\n        columnNumber: 11\n      }\n    })));\n  };\n  if (medias.length > 0) return /*#__PURE__*/React.createElement(Paper, {\n    elevation: 0,\n    square: true,\n    className: classes.viewMediaInputWrapper,\n    onDragOver: handleDragOver,\n    onDragEnter: handleDragEnter,\n    onDragLeave: handleDragLeave,\n    onDrop: handleDrop,\n    style: {\n      border: isDragOver ? \"2px dashed #2196f3\" : \"none\",\n      backgroundColor: isDragOver ? \"#f0f8ff\" : \"#f5f5f5\",\n      transition: \"all 0.3s ease\",\n      position: \"relative\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1159,\n      columnNumber: 7\n    }\n  }, isDragOver && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: \"absolute\",\n      top: \"50%\",\n      left: \"50%\",\n      transform: \"translate(-50%, -50%)\",\n      background: \"rgba(33, 150, 243, 0.9)\",\n      color: \"white\",\n      padding: \"20px\",\n      borderRadius: \"10px\",\n      zIndex: 1000,\n      pointerEvents: \"none\",\n      fontSize: \"16px\",\n      fontWeight: \"bold\",\n      boxShadow: \"0 4px 20px rgba(0,0,0,0.3)\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1176,\n      columnNumber: 11\n    }\n  }, \"\\uD83D\\uDCC1 SUELTA AQU\\xCD PARA ADJUNTAR M\\xC1S ARCHIVOS - NUEVO\"), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: \"flex\",\n      flexWrap: \"wrap\",\n      gap: \"8px\",\n      marginBottom: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1194,\n      columnNumber: 9\n    }\n  }, medias.map((media, index) => /*#__PURE__*/React.createElement(\"div\", {\n    key: index,\n    style: {\n      display: \"flex\",\n      alignItems: \"center\",\n      background: \"#fff\",\n      border: \"1px solid #ddd\",\n      borderRadius: \"8px\",\n      padding: \"6px 10px\",\n      maxWidth: \"200px\",\n      boxShadow: \"0 1px 3px rgba(0,0,0,0.1)\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1196,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      fontSize: \"12px\",\n      color: \"#333\",\n      marginRight: \"8px\",\n      overflow: \"hidden\",\n      textOverflow: \"ellipsis\",\n      whiteSpace: \"nowrap\",\n      flex: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1206,\n      columnNumber: 15\n    }\n  }, getFileType(media), \" \", media.name, uploadProgress[index] !== undefined && /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      color: '#2196f3',\n      fontSize: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1217,\n      columnNumber: 19\n    }\n  }, ' ', \"(\", uploadProgress[index], \"%)\")), /*#__PURE__*/React.createElement(IconButton, {\n    \"aria-label\": \"remove-media\",\n    component: \"span\",\n    onClick: () => handleRemoveMedia(index),\n    size: \"small\",\n    style: {\n      padding: \"2px\",\n      marginLeft: \"4px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1222,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(CloseIcon, {\n    fontSize: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1229,\n      columnNumber: 17\n    }\n  }))))), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      alignItems: \"center\",\n      padding: \"8px 0\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1235,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: \"flex\",\n      alignItems: \"center\",\n      gap: \"8px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1236,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    \"aria-label\": \"cancel-upload\",\n    component: \"span\",\n    onClick: e => setMedias([]),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1237,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CancelIcon, {\n    className: classes.sendMessageIcons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1242,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"input\", {\n    multiple: true,\n    type: \"file\",\n    id: \"upload-more-button\",\n    disabled: loading || recording || ticketStatus !== \"open\",\n    className: classes.uploadInput,\n    onChange: handleChangeMedias,\n    accept: \"image/*,video/*,audio/*,.pdf,.doc,.docx,.xls,.xlsx,.txt\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1246,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"upload-more-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1255,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    \"aria-label\": \"upload-more\",\n    component: \"span\",\n    disabled: loading || recording || ticketStatus !== \"open\",\n    title: \"Agregar m\\xE1s archivos\",\n    style: {\n      backgroundColor: '#e8f5e8',\n      borderRadius: '50%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1256,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(AttachFileIcon, {\n    className: classes.sendMessageIcons,\n    style: {\n      color: '#4caf50'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1263,\n      columnNumber: 17\n    }\n  })))), loading ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1269,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(LinearWithValueLabel, {\n    progress: percentLoading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1270,\n      columnNumber: 15\n    }\n  })) : /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"center\",\n      flex: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1273,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      fontWeight: \"bold\",\n      color: \"#2196f3\",\n      fontSize: \"14px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1274,\n      columnNumber: 15\n    }\n  }, \"\\uD83D\\uDCC1 \", medias.length, \" archivo\", medias.length > 1 ? 's' : '', \" seleccionado\", medias.length > 1 ? 's' : ''), /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      fontSize: \"11px\",\n      color: \"#666\",\n      textAlign: \"center\",\n      maxWidth: \"300px\",\n      overflow: \"hidden\",\n      textOverflow: \"ellipsis\",\n      whiteSpace: \"nowrap\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1277,\n      columnNumber: 15\n    }\n  }, medias.map(f => f.name).join(\", \")), /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      fontSize: \"10px\",\n      color: \"#4caf50\",\n      textAlign: \"center\",\n      marginTop: \"4px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1280,\n      columnNumber: 15\n    }\n  }, \"\\uD83D\\uDCA1 Arrastra m\\xE1s archivos aqu\\xED o usa el bot\\xF3n verde\")), /*#__PURE__*/React.createElement(IconButton, {\n    \"aria-label\": \"send-upload\",\n    component: \"span\",\n    onClick: handleUploadMedia,\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1286,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(SendIcon, {\n    className: classes.sendMessageIcons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1292,\n      columnNumber: 13\n    }\n  }))));else {\n    return /*#__PURE__*/React.createElement(Paper, {\n      square: true,\n      elevation: 0,\n      className: classes.mainWrapper,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1299,\n        columnNumber: 7\n      }\n    }, replyingMessage && renderReplyingMessage(replyingMessage), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.newMessageBox,\n      onDragOver: handleDragOver,\n      onDragEnter: handleDragEnter,\n      onDragLeave: handleDragLeave,\n      onDrop: handleDrop,\n      style: {\n        border: isDragOver ? \"2px dashed #2196f3\" : \"none\",\n        backgroundColor: isDragOver ? \"#f0f8ff\" : \"transparent\",\n        transition: \"all 0.3s ease\",\n        position: \"relative\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1301,\n        columnNumber: 9\n      }\n    }, isDragOver && /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        position: \"absolute\",\n        top: \"50%\",\n        left: \"50%\",\n        transform: \"translate(-50%, -50%)\",\n        background: \"rgba(33, 150, 243, 0.9)\",\n        color: \"white\",\n        padding: \"20px\",\n        borderRadius: \"10px\",\n        zIndex: 1000,\n        pointerEvents: \"none\",\n        fontSize: \"16px\",\n        fontWeight: \"bold\",\n        boxShadow: \"0 4px 20px rgba(0,0,0,0.3)\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1316,\n        columnNumber: 13\n      }\n    }, \"\\uD83D\\uDCC1 SUELTA AQU\\xCD PARA ADJUNTAR ARCHIVOS - NUEVO\"), /*#__PURE__*/React.createElement(EmojiOptions, {\n      disabled: disableOption(),\n      handleAddEmoji: handleAddEmoji,\n      showEmoji: showEmoji,\n      setShowEmoji: setShowEmoji,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1334,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(FileInput, {\n      disableOption: disableOption,\n      handleChangeMedias: handleChangeMedias,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1341,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"quickReplies\",\n      component: \"span\",\n      disabled: disableOption(),\n      onClick: handleQuickReplyButtonClick,\n      title: \"Respuestas R\\xE1pidas\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1346,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(FlashOnIcon, {\n      className: classes.sendMessageIcons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1353,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(IconButton, {\n      \"aria-label\": \"fileLists\",\n      component: \"span\",\n      disabled: disableOption(),\n      onClick: handleFileListButtonClick,\n      title: \"Listas de Archivos\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1356,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(FolderIcon, {\n      className: classes.sendMessageIcons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1363,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(Menu, {\n      anchorEl: fileListAnchorEl,\n      open: Boolean(fileListAnchorEl),\n      onClose: handleFileListMenuClose,\n      PaperProps: {\n        style: {\n          maxHeight: 300,\n          width: 300\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1366,\n        columnNumber: 11\n      }\n    }, fileListOptions.map(fileList => /*#__PURE__*/React.createElement(MenuItem, {\n      key: fileList.value.id,\n      onClick: () => handleFileListSelect(fileList),\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        fontSize: '14px',\n        padding: '8px 16px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1378,\n        columnNumber: 15\n      }\n    }, fileList.label)), fileListOptions.length === 0 && /*#__PURE__*/React.createElement(MenuItem, {\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1392,\n        columnNumber: 15\n      }\n    }, \"No hay listas de archivos disponibles\")), /*#__PURE__*/React.createElement(SignSwitch, {\n      width: props.width,\n      setSignMessage: setSignMessage,\n      signMessage: signMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1398,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(CustomInput, {\n      loading: loading,\n      inputRef: inputRef,\n      ticketStatus: ticketStatus,\n      inputMessage: inputMessage,\n      setInputMessage: setInputMessage\n      // handleChangeInput={handleChangeInput}\n      ,\n      handleSendMessage: handleSendMessage,\n      handleInputPaste: handleInputPaste,\n      disableOption: disableOption,\n      replyingMessage: replyingMessage,\n      handleQuickAnswersClick: handleQuickAnswersClick,\n      options: options,\n      popupOpen: popupOpen,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1404,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(ActionButtons, {\n      inputMessage: inputMessage,\n      loading: loading,\n      recording: recording,\n      ticketStatus: ticketStatus,\n      handleSendMessage: handleSendMessage,\n      handleCancelAudio: handleCancelAudio,\n      handleUploadAudio: handleUploadAudio,\n      handleStartRecording: handleStartRecording,\n      handleOpenModalForward: handleOpenModalForward,\n      showSelectMessageCheckbox: showSelectMessageCheckbox,\n      setShowSelectMessageCheckbox: setShowSelectMessageCheckbox,\n      setSelectedMessages: setSelectedMessages,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1420,\n        columnNumber: 11\n      }\n    })));\n  }\n};\nexport default withWidth()(MessageInputCustom);","map":{"version":3,"names":["React","useState","useEffect","useContext","useRef","withWidth","isWidthUp","Picker","MicRecorder","clsx","isNil","Reply","makeStyles","Paper","InputBase","CircularProgress","green","grey","AttachFileIcon","IconButton","MoodIcon","SendIcon","CancelIcon","ClearIcon","MicIcon","CheckCircleOutlineIcon","HighlightOffIcon","CloseIcon","FlashOnIcon","FolderIcon","FormControlLabel","Switch","Menu","MenuItem","Autocomplete","isString","isEmpty","isObject","has","i18n","api","axios","RecordingTimer","ReplyMessageContext","ForwardMessageContext","AuthContext","useLocalStorage","toastError","Compressor","LinearWithValueLabel","useQuickMessages","useFiles","logger","Mp3Recorder","bitRate","useStyles","theme","mainWrapper","backgroundColor","palette","bordabox","display","flexDirection","alignItems","borderTop","newMessageBox","newmessagebox","width","padding","messageInputWrapper","marginRight","inputdigita","borderRadius","flex","messageInput","paddingLeft","border","sendMessageIcons","color","ForwardMessageIcons","transform","uploadInput","viewMediaInputWrapper","position","justifyContent","emojiBox","bottom","circleLoading","opacity","top","left","marginLeft","audioLoading","recorderWrapper","alignContent","cancelAudioIcon","sendAudioIcon","replyginMsgWrapper","paddingTop","paddingRight","replyginMsgContainer","overflowY","replyginMsgBody","height","whiteSpace","overflow","replyginContactMsgSideColor","replyginSelfMsgSideColor","messageContactName","fontWeight","EmojiOptions","props","disabled","showEmoji","setShowEmoji","handleAddEmoji","classes","createElement","Fragment","component","onClick","e","prevState","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","className","perLine","showPreview","showSkinTones","onSelect","SignSwitch","setSignMessage","signMessage","style","label","t","labelPlacement","control","size","checked","onChange","target","name","FileInput","handleChangeMedias","disableOption","multiple","type","id","accept","htmlFor","title","ActionButtons","inputMessage","loading","recording","ticketStatus","handleSendMessage","handleCancelAudio","handleUploadAudio","handleStartRecording","handleOpenModalForward","showSelectMessageCheckbox","handleCancelSelection","setShowSelectMessageCheckbox","setSelectedMessages","gap","fontSize","CustomInput","inputRef","setInputMessage","handleInputPaste","handleQuickAnswersClick","options","popupOpen","onKeyPress","shiftKey","key","onPaste","renderPlaceholder","setInputRef","input","focus","current","freeSolo","open","value","closeIcon","getOptionLabel","option","event","opt","mediaPath","setTimeout","scrollTop","scrollHeight","onInputChange","reason","renderInput","params","InputLabelProps","InputProps","rest","Object","assign","placeholder","multiline","maxRows","MessageInputCustom","console","log","ticketId","percentLoading","setPercentLoading","medias","setMedias","setLoading","setRecording","quickMessages","setQuickMessages","setOptions","setPopupOpen","fileLists","setFileLists","fileListOptions","setFileListOptions","fileListAnchorEl","setFileListAnchorEl","isDragOver","setIsDragOver","uploadProgress","setUploadProgress","setReplyingMessage","replyingMessage","user","selectedMessages","setForwardMessageModalOpen","list","listQuickMessages","listFiles","fetchData","companyId","localStorage","getItem","messages","userId","map","m","truncatedMessage","message","length","substring","shortcode","fetchFileLists","files","fileList","truncatedName","startsWith","searchTerm","toLowerCase","filteredOptions","filter","includes","emoji","native","selectedMedias","Array","from","prevMedias","f","newMedias","items","clipboardData","i","item","indexOf","file","getAsFile","handleDragOver","preventDefault","stopPropagation","handleDragEnter","handleDragLeave","currentTarget","contains","relatedTarget","handleDrop","dataTransfer","handleRemoveMedia","indexToRemove","_","index","getFileType","handleUploadQuickMessageMedia","blob","originalFileName","media","debug","filename","extension","split","pop","nameWithoutExt","lastIndexOf","Date","getTime","formData","FormData","append","post","info","err","error","warn","Error","data","get","responseType","timeout","urlParts","lastPart","errorMessage","response","status","code","handleFileListClick","fileOption","publicFolder","fileUrl","process","env","REACT_APP_BACKEND_URL","path","Promise","resolve","handleUploadMedia","totalFiles","completedFiles","failedFiles","prev","reject","quality","success","compressedMedia","onUploadProgress","progress","Math","round","loaded","total","trim","read","fromMe","mediaUrl","body","quotedMsg","navigator","mediaDevices","getUserMedia","audio","start","stop","getMp3","handleQuickReplyButtonClick","handleFileListButtonClick","handleFileListMenuClose","handleFileListSelect","renderReplyingMessage","_message$contact","contact","elevation","square","onDragOver","onDragEnter","onDragLeave","onDrop","transition","background","zIndex","pointerEvents","boxShadow","flexWrap","marginBottom","maxWidth","textOverflow","undefined","textAlign","join","marginTop","anchorEl","Boolean","onClose","PaperProps","maxHeight"],"sources":["C:/laragon/www/whaticket03/waticketsaas/frontend/src/components/MessageInputCustom/index.js"],"sourcesContent":["import React, { useState, useEffect, useContext, useRef } from \"react\";\nimport withWidth, { isWidthUp } from \"@material-ui/core/withWidth\";\nimport \"emoji-mart/css/emoji-mart.css\";\nimport { Picker } from \"emoji-mart\";\nimport MicRecorder from \"mic-recorder-to-mp3\";\nimport clsx from \"clsx\";\nimport { isNil } from \"lodash\";\nimport { Reply } from \"@material-ui/icons\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Paper from \"@material-ui/core/Paper\";\nimport InputBase from \"@material-ui/core/InputBase\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { green, grey } from \"@material-ui/core/colors\";\nimport AttachFileIcon from \"@material-ui/icons/AttachFile\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport MoodIcon from \"@material-ui/icons/Mood\";\nimport SendIcon from \"@material-ui/icons/Send\";\nimport CancelIcon from \"@material-ui/icons/Cancel\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\nimport MicIcon from \"@material-ui/icons/Mic\";\nimport CheckCircleOutlineIcon from \"@material-ui/icons/CheckCircleOutline\";\nimport HighlightOffIcon from \"@material-ui/icons/HighlightOff\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport FlashOnIcon from \"@material-ui/icons/FlashOn\";\nimport FolderIcon from \"@material-ui/icons/Folder\";\nimport { FormControlLabel, Switch, Menu, MenuItem } from \"@material-ui/core\";\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\nimport { isString, isEmpty, isObject, has } from \"lodash\";\n\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport axios from \"axios\";\n\nimport RecordingTimer from \"./RecordingTimer\";\nimport { ReplyMessageContext } from \"../../context/ReplyingMessage/ReplyingMessageContext\";\nimport { ForwardMessageContext } from \"../../context/ForwarMessage/ForwardMessageContext\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nimport { useLocalStorage } from \"../../hooks/useLocalStorage\";\nimport toastError from \"../../errors/toastError\";\n\nimport Compressor from 'compressorjs';\nimport LinearWithValueLabel from \"./ProgressBarCustom\";\n\nimport useQuickMessages from \"../../hooks/useQuickMessages\";\nimport useFiles from \"../../hooks/useFiles\";\nimport logger from \"../../utils/logger\";\n\nconst Mp3Recorder = new MicRecorder({ bitRate: 128 });\n\nconst useStyles = makeStyles((theme) => ({\n  mainWrapper: {\n    backgroundColor: theme.palette.bordabox, //DARK MODE PLW DESIGN//\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    borderTop: \"1px solid rgba(0, 0, 0, 0.12)\",\n  },\n\n  newMessageBox: {\n    backgroundColor: theme.palette.newmessagebox, //DARK MODE PLW DESIGN//\n    width: \"100%\",\n    display: \"flex\",\n    padding: \"7px\",\n    alignItems: \"center\",\n  },\n\n  messageInputWrapper: {\n    padding: 6,\n    marginRight: 7,\n    backgroundColor: theme.palette.inputdigita, //DARK MODE PLW DESIGN//\n    display: \"flex\",\n    borderRadius: 20,\n    flex: 1,\n  },\n\n  messageInput: {\n    paddingLeft: 10,\n    flex: 1,\n    border: \"none\",\n  },\n\n  sendMessageIcons: {\n    color: \"grey\",\n  },\n\n  ForwardMessageIcons: {\n    color: grey[700],\n    transform: 'scaleX(-1)'\n  },\n\n  uploadInput: {\n    display: \"none\",\n  },\n\n  viewMediaInputWrapper: {\n    display: \"flex\",\n    padding: \"10px 13px\",\n    position: \"relative\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    backgroundColor: \"#eee\",\n    borderTop: \"1px solid rgba(0, 0, 0, 0.12)\",\n  },\n\n  emojiBox: {\n    position: \"absolute\",\n    bottom: 63,\n    width: 40,\n    borderTop: \"1px solid #e8e8e8\",\n  },\n\n  circleLoading: {\n    color: green[500],\n    opacity: \"70%\",\n    position: \"absolute\",\n    top: \"20%\",\n    left: \"50%\",\n    marginLeft: -12,\n  },\n\n  audioLoading: {\n    color: green[500],\n    opacity: \"70%\",\n  },\n\n  recorderWrapper: {\n    display: \"flex\",\n    alignItems: \"center\",\n    alignContent: \"middle\",\n  },\n\n  cancelAudioIcon: {\n    color: \"red\",\n  },\n\n  sendAudioIcon: {\n    color: \"green\",\n  },\n\n  replyginMsgWrapper: {\n    display: \"flex\",\n    width: \"100%\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingTop: 8,\n    paddingLeft: 73,\n    paddingRight: 7,\n  },\n\n  replyginMsgContainer: {\n    flex: 1,\n    marginRight: 5,\n    overflowY: \"hidden\",\n    backgroundColor: \"rgba(0, 0, 0, 0.05)\",\n    borderRadius: \"7.5px\",\n    display: \"flex\",\n    position: \"relative\",\n  },\n\n  replyginMsgBody: {\n    padding: 10,\n    height: \"auto\",\n    display: \"block\",\n    whiteSpace: \"pre-wrap\",\n    overflow: \"hidden\",\n  },\n\n  replyginContactMsgSideColor: {\n    flex: \"none\",\n    width: \"4px\",\n    backgroundColor: \"#35cd96\",\n  },\n\n  replyginSelfMsgSideColor: {\n    flex: \"none\",\n    width: \"4px\",\n    backgroundColor: \"#6bcbef\",\n  },\n\n  messageContactName: {\n    display: \"flex\",\n    color: \"#6bcbef\",\n    fontWeight: 500,\n  },\n}));\n\nconst EmojiOptions = (props) => {\n  const { disabled, showEmoji, setShowEmoji, handleAddEmoji } = props;\n  const classes = useStyles();\n  return (\n    <>\n      <IconButton\n        aria-label=\"emojiPicker\"\n        component=\"span\"\n        disabled={disabled}\n        onClick={(e) => setShowEmoji((prevState) => !prevState)}\n      >\n        <MoodIcon className={classes.sendMessageIcons} />\n      </IconButton>\n      {showEmoji ? (\n        <div className={classes.emojiBox}>\n          <Picker\n            perLine={16}\n            showPreview={false}\n            showSkinTones={false}\n            onSelect={handleAddEmoji}\n          />\n        </div>\n      ) : null}\n    </>\n  );\n};\n\nconst SignSwitch = (props) => {\n  const { width, setSignMessage, signMessage } = props;\n  if (isWidthUp(\"md\", width)) {\n    return (\n      <FormControlLabel\n        style={{ marginRight: 7, color: \"gray\" }}\n        label={i18n.t(\"messagesInput.signMessage\")}\n        labelPlacement=\"start\"\n        control={\n          <Switch\n            size=\"small\"\n            checked={signMessage}\n            onChange={(e) => {\n              setSignMessage(e.target.checked);\n            }}\n            name=\"showAllTickets\"\n            color=\"primary\"\n          />\n        }\n      />\n    );\n  }\n  return null;\n};\n\nconst FileInput = (props) => {\n  const { handleChangeMedias, disableOption } = props;\n  const classes = useStyles();\n  return (\n    <>\n      <input\n        multiple\n        type=\"file\"\n        id=\"upload-button\"\n        disabled={disableOption()}\n        className={classes.uploadInput}\n        onChange={handleChangeMedias}\n        accept=\"image/*,video/*,audio/*,.pdf,.doc,.docx,.xls,.xlsx,.txt\"\n      />\n      <label htmlFor=\"upload-button\">\n        <IconButton\n          aria-label=\"upload\"\n          component=\"span\"\n          disabled={disableOption()}\n          title=\"Adjuntar archivos (mÃºltiples) - NUEVO\"\n          style={{ backgroundColor: '#e3f2fd', borderRadius: '50%' }}\n        >\n          <AttachFileIcon className={classes.sendMessageIcons} style={{ color: '#2196f3' }} />\n        </IconButton>\n      </label>\n    </>\n  );\n};\n\nconst ActionButtons = (props) => {\n  const {\n    inputMessage,\n    loading,\n    recording,\n    ticketStatus,\n    handleSendMessage,\n    handleCancelAudio,\n    handleUploadAudio,\n    handleStartRecording,\n    handleOpenModalForward,\n    showSelectMessageCheckbox\n  } = props;\n  const classes = useStyles();\n  \n  // âœ… FUNCIÃ“N PARA CANCELAR SELECCIÃ“N DE MENSAJES\n  const handleCancelSelection = () => {\n    const { setShowSelectMessageCheckbox, setSelectedMessages } = props;\n    setShowSelectMessageCheckbox(false);\n    setSelectedMessages([]);\n  };\n  \n  if (showSelectMessageCheckbox) {\n    return (\n      <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n        {/* âœ… BOTÃ“N CANCELAR */}\n        <IconButton\n          aria-label=\"cancelSelection\"\n          component=\"span\"\n          onClick={handleCancelSelection}\n          disabled={loading}\n          style={{ color: '#f44336' }}\n          title=\"Cancelar selecciÃ³n\"\n        >\n          <HighlightOffIcon className={classes.sendMessageIcons} />\n        </IconButton>\n        <IconButton\n          aria-label=\"forwardMessage\"\n          component=\"span\"\n          onClick={handleOpenModalForward}\n          disabled={loading}\n        >\n          <Reply className={classes.ForwardMessageIcons} />\n        </IconButton>\n      </div>\n    );\n  } else if (inputMessage) {\n    return (\n      <IconButton\n        aria-label=\"sendMessage\"\n        component=\"span\"\n        onClick={handleSendMessage}\n        disabled={loading}\n      >\n        <SendIcon className={classes.sendMessageIcons} />\n      </IconButton>\n    );\n  } else if (recording) {\n    return (\n      <div className={classes.recorderWrapper}>\n        <IconButton\n          aria-label=\"cancelRecording\"\n          component=\"span\"\n          fontSize=\"large\"\n          disabled={loading}\n          onClick={handleCancelAudio}\n        >\n          <HighlightOffIcon className={classes.cancelAudioIcon} />\n        </IconButton>\n        {loading ? (\n          <div>\n            <CircularProgress className={classes.audioLoading} />\n          </div>\n        ) : (\n          <RecordingTimer />\n        )}\n\n        <IconButton\n          aria-label=\"sendRecordedAudio\"\n          component=\"span\"\n          onClick={handleUploadAudio}\n          disabled={loading}\n        >\n          <CheckCircleOutlineIcon className={classes.sendAudioIcon} />\n        </IconButton>\n      </div>\n    );\n  } else {\n    return (\n      <IconButton\n        aria-label=\"showRecorder\"\n        component=\"span\"\n        disabled={loading || ticketStatus !== \"open\"}\n        onClick={handleStartRecording}\n      >\n        <MicIcon className={classes.sendMessageIcons} />\n      </IconButton>\n    );\n  }\n};\n\nconst CustomInput = (props) => {\n  const {\n    loading,\n    inputRef,\n    ticketStatus,\n    inputMessage,\n    setInputMessage,\n    handleSendMessage,\n    handleInputPaste,\n    disableOption,\n    handleQuickAnswersClick,\n    options,\n    popupOpen\n  } = props;\n  const classes = useStyles();\n\n  const onKeyPress = (e) => {\n    if (loading || e.shiftKey) return;\n    else if (e.key === \"Enter\") {\n      handleSendMessage();\n    }\n  };\n\n  const onPaste = (e) => {\n    if (ticketStatus === \"open\") {\n      handleInputPaste(e);\n    }\n  };\n\n  const renderPlaceholder = () => {\n    if (ticketStatus === \"open\") {\n      return i18n.t(\"messagesInput.placeholderOpen\") + \" (usa / para respuestas rÃ¡pidas)\";\n    }\n    return i18n.t(\"messagesInput.placeholderClosed\");\n  };\n\n\n  const setInputRef = (input) => {\n    if (input) {\n      input.focus();\n      inputRef.current = input;\n    }\n  };\n\n  return (\n    <div className={classes.messageInputWrapper}>\n      <Autocomplete\n        freeSolo\n        open={popupOpen}\n        id=\"quick-messages-autocomplete\"\n        value={inputMessage}\n        options={options}\n        closeIcon={null}\n        getOptionLabel={(option) => {\n          if (isObject(option)) {\n            return option.label;\n          } else {\n            return option;\n          }\n        }}\n        onChange={(event, opt) => {\n         \n          if (isObject(opt) && has(opt, \"value\") && isNil(opt.mediaPath)) {\n            setInputMessage(opt.value);\n            setTimeout(() => {\n              inputRef.current.scrollTop = inputRef.current.scrollHeight;\n            }, 200);\n          } else if (isObject(opt) && has(opt, \"value\") && !isNil(opt.mediaPath)) {\n            handleQuickAnswersClick(opt);\n\n            setTimeout(() => {\n              inputRef.current.scrollTop = inputRef.current.scrollHeight;\n            }, 200);\n          }\n        }}\n        onInputChange={(event, opt, reason) => {\n          if (reason === \"input\") {\n            setInputMessage(event.target.value);\n          }\n        }}\n        onPaste={onPaste}\n        onKeyPress={onKeyPress}\n        style={{ width: \"100%\" }}\n        renderInput={(params) => {\n          const { InputLabelProps, InputProps, ...rest } = params;\n          return (\n            <InputBase\n              {...params.InputProps}\n              {...rest}\n              disabled={disableOption()}\n              inputRef={setInputRef}\n              placeholder={renderPlaceholder()}\n              multiline\n              className={classes.messageInput}\n              maxRows={5}\n            />\n          );\n        }}\n      />\n    </div>\n  );\n};\n\nconst MessageInputCustom = (props) => {\n  console.log(\"ðŸš€ MessageInputCustom cargado - VersiÃ³n mejorada con envÃ­o mÃºltiple - CAMBIO VISIBLE\");\n  const { ticketStatus, ticketId } = props;\n  const classes = useStyles();\n  const [percentLoading, setPercentLoading] = useState(0);\n  const [medias, setMedias] = useState([]);\n  const [inputMessage, setInputMessage] = useState(\"\");\n  const [showEmoji, setShowEmoji] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [recording, setRecording] = useState(false);\n  const [quickMessages, setQuickMessages] = useState([]);\n  const [options, setOptions] = useState([]);\n  const [popupOpen, setPopupOpen] = useState(false);\n  const [fileLists, setFileLists] = useState([]);\n  const [fileListOptions, setFileListOptions] = useState([]);\n  const [fileListAnchorEl, setFileListAnchorEl] = useState(null);\n  const [isDragOver, setIsDragOver] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState({});\n  const inputRef = useRef();\n  const { setReplyingMessage, replyingMessage } =\n    useContext(ReplyMessageContext);\n  const { user } = useContext(AuthContext);\n\n  const [signMessage, setSignMessage] = useLocalStorage(\"signOption\", true);\n\n  const {\n    selectedMessages,\n    setForwardMessageModalOpen,\n    showSelectMessageCheckbox,\n    setShowSelectMessageCheckbox,\n    setSelectedMessages } = useContext(ForwardMessageContext);\n\n  const { list: listQuickMessages } = useQuickMessages();\n  const { list: listFiles } = useFiles();\n\n  // Cargar respuestas rÃ¡pidas\n  useEffect(() => {\n    async function fetchData() {\n      const companyId = localStorage.getItem(\"companyId\");\n      const messages = await listQuickMessages({ companyId, userId: user.id });\n      const options = messages.map((m) => {\n        let truncatedMessage = m.message;\n        if (isString(truncatedMessage) && truncatedMessage.length > 35) {\n          truncatedMessage = m.message.substring(0, 35) + \"...\";\n        }\n        return {\n          value: m.message,\n          label: `/${m.shortcode} - ${truncatedMessage}`,\n          shortcode: m.shortcode,\n          message: m.message,\n          mediaPath: m.mediaPath,\n        };\n      });\n      setQuickMessages(options);\n    }\n    fetchData();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Cargar listas de archivos\n  useEffect(() => {\n    async function fetchFileLists() {\n      const companyId = localStorage.getItem(\"companyId\");\n      const files = await listFiles({ companyId, userId: user.id });\n      const options = files.map((fileList) => {\n        let truncatedName = fileList.name;\n        if (isString(truncatedName) && truncatedName.length > 35) {\n          truncatedName = fileList.name.substring(0, 35) + \"...\";\n        }\n        return {\n          value: fileList,\n          label: `ðŸ“ ${truncatedName}`,\n          name: fileList.name,\n          message: fileList.message,\n          options: fileList.options,\n        };\n      });\n      setFileLists(options);\n    }\n    fetchFileLists();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Manejar autocompletado de respuestas rÃ¡pidas\n  useEffect(() => {\n    if (\n      isString(inputMessage) &&\n      !isEmpty(inputMessage) &&\n      inputMessage.startsWith(\"/\")\n    ) {\n      setPopupOpen(true);\n\n      // Si solo hay \"/\", mostrar todas las opciones\n      if (inputMessage === \"/\") {\n        setOptions(quickMessages);\n      } else {\n        // Filtrar por lo que se escriba despuÃ©s de \"/\"\n        const searchTerm = inputMessage.substring(1).toLowerCase();\n        const filteredOptions = quickMessages.filter(\n          (m) => \n            m.shortcode.toLowerCase().includes(searchTerm) ||\n            m.message.toLowerCase().includes(searchTerm)\n        );\n        setOptions(filteredOptions);\n      }\n    } else {\n      setPopupOpen(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [inputMessage]);\n\n  useEffect(() => {\n    inputRef.current.focus();\n  }, [replyingMessage]);\n\n  useEffect(() => {\n    inputRef.current.focus();\n    return () => {\n      console.log(\"ðŸ§¹ Limpiando estado al cambiar ticketId:\", ticketId);\n      setInputMessage(\"\");\n      setShowEmoji(false);\n      setMedias([]);\n      setReplyingMessage(null);\n    };\n  }, [ticketId, setReplyingMessage]);\n\n  // const handleChangeInput = e => {\n  // \tif (isObject(e) && has(e, 'value')) {\n  // \t\tsetInputMessage(e.value);\n  // \t} else {\n  // \t\tsetInputMessage(e.target.value)\n  // \t}\n  // };\n\n  const handleOpenModalForward = () => {\n    if (selectedMessages.length === 0) {\n      setForwardMessageModalOpen(false)\n      toastError(i18n.t(\"messagesList.header.notMessage\"));\n      return;\n    }\n    setForwardMessageModalOpen(true);\n  }\n\n  const handleAddEmoji = (e) => {\n    let emoji = e.native;\n    setInputMessage((prevState) => prevState + emoji);\n  };\n\n  const handleChangeMedias = (e) => {\n    if (!e.target.files) {\n      return;\n    }\n\n    const selectedMedias = Array.from(e.target.files);\n    console.log(\"ðŸŽ¯ handleChangeMedias ejecutado - Archivos seleccionados:\", selectedMedias.length);\n    \n    // âœ… MEJORA: Acumular archivos en lugar de reemplazar\n    setMedias(prevMedias => {\n      console.log(\"ðŸ“Š Estado anterior de medias:\", prevMedias.length, prevMedias.map(f => f.name));\n      const newMedias = [...prevMedias, ...selectedMedias];\n      console.log(\"ðŸ“ Archivos acumulados:\", newMedias.length, newMedias.map(f => f.name));\n      return newMedias;\n    });\n  };\n\n  const handleInputPaste = (e) => {\n    const items = e.clipboardData.items;\n    if (!items) return;\n\n    for (let i = 0; i < items.length; i++) {\n      const item = items[i];\n      if (item.type.indexOf('image') !== -1) {\n        const file = item.getAsFile();\n        if (file) {\n          console.log(\"ðŸ“‹ Imagen pegada:\", file.name || \"imagen_pegada\");\n          setMedias(prevMedias => [...prevMedias, file]);\n        }\n      }\n    }\n  };\n\n  // âœ… MEJORA: Drag & Drop mÃºltiple\n  const handleDragOver = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    console.log(\"ðŸŽ¯ DragOver detectado\");\n    setIsDragOver(true);\n  };\n\n  const handleDragEnter = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    console.log(\"ðŸŽ¯ DragEnter detectado\");\n    setIsDragOver(true);\n  };\n\n  const handleDragLeave = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (!e.currentTarget.contains(e.relatedTarget)) {\n      console.log(\"ðŸŽ¯ DragLeave detectado\");\n      setIsDragOver(false);\n    }\n  };\n\n  const handleDrop = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    console.log(\"ðŸŽ¯ Drop detectado\");\n    setIsDragOver(false);\n    \n    const files = Array.from(e.dataTransfer.files);\n    console.log(\"ðŸ“ Archivos en drop:\", files.length, files.map(f => f.name));\n    \n    if (files.length > 0) {\n      setMedias(prevMedias => {\n        console.log(\"ðŸ“Š Estado anterior de medias (drop):\", prevMedias.length, prevMedias.map(f => f.name));\n        const newMedias = [...prevMedias, ...files];\n        console.log(\"ðŸ–±ï¸ Archivos arrastrados:\", files.length, files.map(f => f.name));\n        console.log(\"ðŸ“ Total archivos:\", newMedias.length, newMedias.map(f => f.name));\n        return newMedias;\n      });\n    }\n  };\n\n  // âœ… MEJORA: Eliminar archivo especÃ­fico\n  const handleRemoveMedia = (indexToRemove) => {\n    setMedias(prevMedias => prevMedias.filter((_, index) => index !== indexToRemove));\n  };\n\n  // âœ… MEJORA: FunciÃ³n para obtener el tipo de archivo\n  const getFileType = (file) => {\n    if (file.type.startsWith('image/')) return 'ðŸ–¼ï¸';\n    if (file.type.startsWith('video/')) return 'ðŸŽ¥';\n    if (file.type.startsWith('audio/')) return 'ðŸŽµ';\n    if (file.type.includes('pdf')) return 'ðŸ“„';\n    if (file.type.includes('document') || file.type.includes('word')) return 'ðŸ“';\n    if (file.type.includes('sheet') || file.type.includes('excel')) return 'ðŸ“Š';\n    return 'ðŸ“Ž';\n  };\n\n  const handleUploadQuickMessageMedia = async (blob, originalFileName) => {\n    try {\n      if (logger && logger.media) {\n        logger.media.debug(\"Procesando multimedia para envÃ­o, tipo:\", blob.type);\n        logger.media.debug(\"Nombre original del archivo:\", originalFileName);\n      }\n      \n      // Mantener el nombre original del archivo\n      let filename = originalFileName;\n      \n      // Si el nombre es muy extenso (mÃ¡s de 50 caracteres), truncarlo\n              if (filename && filename.length > 50) {\n          const extension = filename.split('.').pop();\n          const nameWithoutExt = filename.substring(0, filename.lastIndexOf('.'));\n          const truncatedName = nameWithoutExt.substring(0, 47) + '...';\n          filename = `${truncatedName}.${extension}`;\n          if (logger && logger.media) {\n            logger.media.debug(\"Nombre truncado:\", filename);\n          }\n        }\n        \n        // Si no hay nombre original, generar uno con timestamp\n        if (!filename) {\n          const extension = blob.type.split(\"/\")[1] || 'bin';\n          filename = `${new Date().getTime()}.${extension}`;\n          if (logger && logger.media) {\n            logger.media.debug(\"Nombre generado:\", filename);\n          }\n        }\n        \n        if (logger && logger.media) {\n          logger.media.debug(\"Nombre final del archivo:\", filename);\n        }\n\n        const formData = new FormData();\n        formData.append(\"medias\", blob, filename);\n        formData.append(\"body\", filename); // Usar el nombre del archivo como body\n        formData.append(\"fromMe\", true);\n\n        if (logger && logger.media) {\n          logger.media.debug(\"Enviando multimedia al servidor...\");\n        }\n        \n        await api.post(`/messages/${ticketId}`, formData);\n        \n        if (logger && logger.media) {\n          logger.media.info(\"Multimedia enviada exitosamente\");\n        }\n      } catch (err) {\n        if (logger && logger.media) {\n          logger.media.error(\"Error al enviar multimedia:\", err);\n        }\n        toastError(err);\n        throw err; // Re-lanzar el error para que lo maneje la funciÃ³n padre\n      }\n  };\n  \n  const handleQuickAnswersClick = async (value) => {\n    if (value.mediaPath) {\n      setLoading(true);\n      try {\n        if (logger && logger.media) {\n          logger.media.debug(\"Descargando multimedia desde:\", value.mediaPath);\n          logger.media.debug(\"URL completa:\", value.mediaPath);\n        }\n        \n        // âœ… Validar que la URL sea vÃ¡lida\n        if (!value.mediaPath || value.mediaPath === 'null' || value.mediaPath === 'undefined' || value.mediaPath.includes('undefined')) {\n          if (logger && logger.media) {\n            logger.media.warn(\"URL de multimedia invÃ¡lida:\", value.mediaPath);\n          }\n          toastError(new Error(\"URL de multimedia invÃ¡lida - Contacte al administrador\"));\n          setLoading(false);\n          setInputMessage(value.value);\n          return;\n        }\n        \n        const { data } = await axios.get(value.mediaPath, {\n          responseType: \"blob\",\n          timeout: 10000, // 10 segundos de timeout\n        });\n\n        if (logger && logger.media) {\n          logger.media.debug(\"Multimedia descargada exitosamente, tamaÃ±o:\", data.size);\n        }\n        \n        // âœ… EXTRAER NOMBRE REAL DEL ARCHIVO DESDE LA URL\n        let fileName = value.value; // Fallback al texto de respuesta rÃ¡pida\n        \n        if (value.mediaPath) {\n          // Extraer nombre desde la URL del archivo\n          const urlParts = value.mediaPath.split('/');\n          const lastPart = urlParts[urlParts.length - 1];\n          \n          if (lastPart && lastPart.includes('.')) {\n            fileName = lastPart;\n            if (logger && logger.media) {\n              logger.media.debug(\"Nombre extraÃ­do desde URL:\", fileName);\n            }\n          }\n        }\n        \n        await handleUploadQuickMessageMedia(data, fileName);\n        setInputMessage(\"\");\n        setLoading(false);\n        return;\n      } catch (err) {\n        console.error(\"Error al procesar multimedia de respuesta rÃ¡pida:\", err);\n        console.error(\"URL que fallÃ³:\", value.mediaPath);\n        \n        // Mostrar error mÃ¡s especÃ­fico\n        let errorMessage = \"Error al procesar multimedia\";\n        if (err.response) {\n          if (err.response.status === 404) {\n            errorMessage = \"Archivo multimedia no encontrado\";\n          } else if (err.response.status === 403) {\n            errorMessage = \"Sin permisos para acceder al archivo\";\n          } else {\n            errorMessage = `Error del servidor: ${err.response.status}`;\n          }\n        } else if (err.code === 'ECONNABORTED') {\n          errorMessage = \"Tiempo de espera agotado\";\n        }\n        \n        toastError(new Error(errorMessage));\n        setLoading(false);\n        \n        // Si falla la multimedia, al menos enviar el texto\n        setInputMessage(value.value);\n        return;\n      }\n    }\n\n    setInputMessage(\"\");\n    setInputMessage(value.value);\n  };\n\n  const handleFileListClick = async (value) => {\n    if (logger && logger.media) {\n      logger.media.debug(\"Valor recibido en handleFileListClick:\", value);\n    }\n    \n    // Verificar si value.value.options existe (estructura correcta)\n    if (!value.value || !value.value.options || value.value.options.length === 0) {\n      if (logger && logger.media) {\n        logger.media.warn(\"No hay archivos en la lista. value.value:\", value.value);\n      }\n      toastError(\"Esta lista de archivos no contiene archivos\");\n      return;\n    }\n\n    setLoading(true);\n    try {\n      if (logger && logger.media) {\n        logger.media.debug(\"Enviando lista de archivos:\", value.name);\n        logger.media.debug(\"Archivos en la lista:\", value.value.options.length);\n      }\n\n      // Enviar cada archivo de la lista\n      for (const fileOption of value.value.options) {\n        try {\n          if (logger && logger.media) {\n            logger.media.debug(\"Procesando archivo:\", fileOption.name);\n          }\n          \n          // Construir URL del archivo\n          const publicFolder = \"public/fileList\";\n          const fileUrl = `${process.env.REACT_APP_BACKEND_URL || 'http://localhost:8080'}/${publicFolder}/${value.value.id}/${fileOption.path}`;\n          \n          if (logger && logger.media) {\n            logger.media.debug(\"URL del archivo:\", fileUrl);\n          }\n          \n          // Extraer nombre del archivo desde la ruta\n          const fileName = fileOption.path || fileOption.name || 'documento';\n          if (logger && logger.media) {\n            logger.media.debug(\"Nombre del archivo extraÃ­do:\", fileName);\n          }\n          \n          // Descargar archivo\n          const { data } = await axios.get(fileUrl, {\n            responseType: \"blob\",\n            timeout: 10000,\n          });\n\n          if (logger && logger.media) {\n            logger.media.debug(\"Archivo descargado:\", fileName, \"tamaÃ±o:\", data.size);\n          }\n          \n          // Enviar archivo\n          await handleUploadQuickMessageMedia(data, fileName);\n          \n          // PequeÃ±a pausa entre archivos para no sobrecargar\n          await new Promise(resolve => setTimeout(resolve, 500));\n          \n        } catch (err) {\n          if (logger && logger.media) {\n            logger.media.error(\"Error procesando archivo:\", fileOption.name, err);\n          }\n          toastError(`Error al procesar archivo: ${fileOption.name}`);\n        }\n      }\n      \n      if (logger && logger.media) {\n        logger.media.info(\"Lista de archivos enviada exitosamente\");\n      }\n      setLoading(false);\n      \n    } catch (err) {\n      if (logger && logger.media) {\n        logger.media.error(\"Error al enviar lista de archivos:\", err);\n      }\n      toastError(\"Error al enviar lista de archivos\");\n      setLoading(false);\n    }\n  };\n\n  const handleUploadMedia = async (e) => {\n    setLoading(true);\n    e.preventDefault();\n\n    console.log(\"ðŸš€ Iniciando envÃ­o de\", medias.length, \"archivos\");\n    \n    const totalFiles = medias.length;\n    let completedFiles = 0;\n    let failedFiles = 0;\n\n    // âœ… MEJORA: Enviar cada archivo por separado\n    for (let i = 0; i < medias.length; i++) {\n      const media = medias[i];\n      console.log(`ðŸ“¤ Enviando archivo ${i + 1}/${totalFiles}:`, media.name);\n\n      try {\n        // Actualizar progreso\n        setUploadProgress(prev => ({\n          ...prev,\n          [i]: 0\n        }));\n\n        if (media?.type.split('/')[0] === 'image') {\n          // âœ… MEJORA: Manejar compresiÃ³n de imÃ¡genes correctamente\n          await new Promise((resolve, reject) => {\n            new Compressor(media, {\n              quality: 0.7,\n              async success(compressedMedia) {\n                try {\n                  const formData = new FormData();\n                  formData.append(\"fromMe\", true);\n                  formData.append(\"medias\", compressedMedia);\n                  formData.append(\"body\", media.name);\n\n                  await api.post(`/messages/${ticketId}`, formData, {\n                    onUploadProgress: (event) => {\n                      const progress = Math.round((event.loaded * 100) / event.total);\n                      setUploadProgress(prev => ({\n                        ...prev,\n                        [i]: progress\n                      }));\n                      console.log(`ðŸ“Š ${media.name}: ${progress}%`);\n                    },\n                  });\n\n                  completedFiles++;\n                  console.log(`âœ… Archivo ${i + 1}/${totalFiles} enviado:`, media.name);\n                  resolve();\n                } catch (err) {\n                  console.error(`âŒ Error enviando ${media.name}:`, err);\n                  failedFiles++;\n                  reject(err);\n                }\n              },\n              error(err) {\n                console.error(`âŒ Error comprimiendo ${media.name}:`, err);\n                failedFiles++;\n                reject(err);\n              },\n            });\n          });\n        } else {\n          // âœ… MEJORA: Enviar archivos no-imagen directamente\n          const formData = new FormData();\n          formData.append(\"fromMe\", true);\n          formData.append(\"medias\", media);\n          formData.append(\"body\", media.name);\n\n          await api.post(`/messages/${ticketId}`, formData, {\n            onUploadProgress: (event) => {\n              const progress = Math.round((event.loaded * 100) / event.total);\n              setUploadProgress(prev => ({\n                ...prev,\n                [i]: progress\n              }));\n              console.log(`ðŸ“Š ${media.name}: ${progress}%`);\n            },\n          });\n\n          completedFiles++;\n          console.log(`âœ… Archivo ${i + 1}/${totalFiles} enviado:`, media.name);\n        }\n      } catch (err) {\n        console.error(`âŒ Error enviando archivo ${media.name}:`, err);\n        failedFiles++;\n        toastError(err);\n      }\n    }\n\n    setLoading(false);\n    setMedias([]);\n    setUploadProgress({});\n    console.log(`ðŸŽ‰ EnvÃ­o completado: ${completedFiles}/${totalFiles} archivos enviados, ${failedFiles} fallidos`);\n  }\n\n  const handleSendMessage = async () => {\n    if (inputMessage.trim() === \"\") return;\n    setLoading(true);\n\n    const message = {\n      read: 1,\n      fromMe: true,\n      mediaUrl: \"\",\n      body: signMessage\n        ? `*${user?.name}:*\\n${inputMessage.trim()}`\n        : inputMessage.trim(),\n      quotedMsg: replyingMessage,\n    };\n    try {\n      await api.post(`/messages/${ticketId}`, message);\n    } catch (err) {\n      toastError(err);\n    }\n\n    setInputMessage(\"\");\n    setShowEmoji(false);\n    setLoading(false);\n    setReplyingMessage(null);\n  };\n\n  const handleStartRecording = async () => {\n    setLoading(true);\n    try {\n      await navigator.mediaDevices.getUserMedia({ audio: true });\n      await Mp3Recorder.start();\n      setRecording(true);\n      setLoading(false);\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n  };\n\n  const handleUploadAudio = async () => {\n    setLoading(true);\n    try {\n      const [, blob] = await Mp3Recorder.stop().getMp3();\n      if (blob.size < 10000) {\n        setLoading(false);\n        setRecording(false);\n        return;\n      }\n\n      const formData = new FormData();\n      const filename = `audio-record-site-${new Date().getTime()}.mp3`;\n      formData.append(\"medias\", blob, filename);\n      formData.append(\"body\", filename);\n      formData.append(\"fromMe\", true);\n\n      await api.post(`/messages/${ticketId}`, formData);\n    } catch (err) {\n      toastError(err);\n    }\n\n    setRecording(false);\n    setLoading(false);\n  };\n\n  const handleCancelAudio = async () => {\n    try {\n      await Mp3Recorder.stop().getMp3();\n      setRecording(false);\n    } catch (err) {\n      toastError(err);\n    }\n  };\n\n  const handleQuickReplyButtonClick = () => {\n    setInputMessage(\"/\");\n    // Forzar que se muestren las opciones inmediatamente\n    setTimeout(() => {\n      setPopupOpen(true);\n      setOptions(quickMessages);\n    }, 100);\n    if (inputRef.current) {\n      inputRef.current.focus();\n    }\n  };\n\n  const handleFileListButtonClick = (event) => {\n    setFileListAnchorEl(event.currentTarget);\n    setFileListOptions(fileLists);\n  };\n\n  const handleFileListMenuClose = () => {\n    setFileListAnchorEl(null);\n  };\n\n  const handleFileListSelect = (fileList) => {\n    handleFileListClick(fileList);\n    handleFileListMenuClose();\n  };\n\n  const disableOption = () => {\n    return loading || recording || ticketStatus !== \"open\";\n  };\n\n  const renderReplyingMessage = (message) => {\n    return (\n      <div className={classes.replyginMsgWrapper}>\n        <div className={classes.replyginMsgContainer}>\n          <span\n            className={clsx(classes.replyginContactMsgSideColor, {\n              [classes.replyginSelfMsgSideColor]: !message.fromMe,\n            })}\n          ></span>\n          <div className={classes.replyginMsgBody}>\n            {!message.fromMe && (\n              <span className={classes.messageContactName}>\n                {message.contact?.name}\n              </span>\n            )}\n            {message.body}\n          </div>\n        </div>\n        <IconButton\n          aria-label=\"showRecorder\"\n          component=\"span\"\n          disabled={loading || ticketStatus !== \"open\"}\n          onClick={() => setReplyingMessage(null)}\n        >\n          <ClearIcon className={classes.sendMessageIcons} />\n        </IconButton>\n      </div>\n    );\n  };\n\n  if (medias.length > 0)\n    return (\n      <Paper \n        elevation={0} \n        square \n        className={classes.viewMediaInputWrapper}\n        onDragOver={handleDragOver}\n        onDragEnter={handleDragEnter}\n        onDragLeave={handleDragLeave}\n        onDrop={handleDrop}\n        style={{\n          border: isDragOver ? \"2px dashed #2196f3\" : \"none\",\n          backgroundColor: isDragOver ? \"#f0f8ff\" : \"#f5f5f5\",\n          transition: \"all 0.3s ease\",\n          position: \"relative\"\n        }}\n      >\n        {/* Indicador de drag & drop para vista de archivos */}\n        {isDragOver && (\n          <div style={{\n            position: \"absolute\",\n            top: \"50%\",\n            left: \"50%\",\n            transform: \"translate(-50%, -50%)\",\n            background: \"rgba(33, 150, 243, 0.9)\",\n            color: \"white\",\n            padding: \"20px\",\n            borderRadius: \"10px\",\n            zIndex: 1000,\n            pointerEvents: \"none\",\n            fontSize: \"16px\",\n            fontWeight: \"bold\",\n            boxShadow: \"0 4px 20px rgba(0,0,0,0.3)\"\n          }}>\n            ðŸ“ SUELTA AQUÃ PARA ADJUNTAR MÃS ARCHIVOS - NUEVO\n          </div>\n        )}\n        <div style={{ display: \"flex\", flexWrap: \"wrap\", gap: \"8px\", marginBottom: \"10px\" }}>\n          {medias.map((media, index) => (\n            <div key={index} style={{ \n              display: \"flex\", \n              alignItems: \"center\", \n              background: \"#fff\", \n              border: \"1px solid #ddd\", \n              borderRadius: \"8px\", \n              padding: \"6px 10px\", \n              maxWidth: \"200px\", \n              boxShadow: \"0 1px 3px rgba(0,0,0,0.1)\" \n            }}>\n              <span style={{ \n                fontSize: \"12px\", \n                color: \"#333\", \n                marginRight: \"8px\", \n                overflow: \"hidden\", \n                textOverflow: \"ellipsis\", \n                whiteSpace: \"nowrap\", \n                flex: 1 \n              }}>\n                {getFileType(media)} {media.name}\n                {uploadProgress[index] !== undefined && (\n                  <span style={{ color: '#2196f3', fontSize: '10px' }}>\n                    {' '}({uploadProgress[index]}%)\n                  </span>\n                )}\n              </span>\n              <IconButton\n                aria-label=\"remove-media\"\n                component=\"span\"\n                onClick={() => handleRemoveMedia(index)}\n                size=\"small\"\n                style={{ padding: \"2px\", marginLeft: \"4px\" }}\n              >\n                <CloseIcon fontSize=\"small\" />\n              </IconButton>\n            </div>\n          ))}\n        </div>\n        \n        <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", padding: \"8px 0\" }}>\n          <div style={{ display: \"flex\", alignItems: \"center\", gap: \"8px\" }}>\n            <IconButton\n              aria-label=\"cancel-upload\"\n              component=\"span\"\n              onClick={(e) => setMedias([])}\n            >\n              <CancelIcon className={classes.sendMessageIcons} />\n            </IconButton>\n            \n            {/* âœ… MEJORA: BotÃ³n para agregar mÃ¡s archivos */}\n            <input\n              multiple\n              type=\"file\"\n              id=\"upload-more-button\"\n              disabled={loading || recording || ticketStatus !== \"open\"}\n              className={classes.uploadInput}\n              onChange={handleChangeMedias}\n              accept=\"image/*,video/*,audio/*,.pdf,.doc,.docx,.xls,.xlsx,.txt\"\n            />\n            <label htmlFor=\"upload-more-button\">\n              <IconButton\n                aria-label=\"upload-more\"\n                component=\"span\"\n                disabled={loading || recording || ticketStatus !== \"open\"}\n                title=\"Agregar mÃ¡s archivos\"\n                style={{ backgroundColor: '#e8f5e8', borderRadius: '50%' }}\n              >\n                <AttachFileIcon className={classes.sendMessageIcons} style={{ color: '#4caf50' }} />\n              </IconButton>\n            </label>\n          </div>\n\n          {loading ? (\n            <div>\n              <LinearWithValueLabel progress={percentLoading} />\n            </div>\n          ) : (\n            <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\", flex: 1 }}>\n              <span style={{ fontWeight: \"bold\", color: \"#2196f3\", fontSize: \"14px\" }}>\n                ðŸ“ {medias.length} archivo{medias.length > 1 ? 's' : ''} seleccionado{medias.length > 1 ? 's' : ''}\n              </span>\n              <span style={{ fontSize: \"11px\", color: \"#666\", textAlign: \"center\", maxWidth: \"300px\", overflow: \"hidden\", textOverflow: \"ellipsis\", whiteSpace: \"nowrap\" }}>\n                {medias.map(f => f.name).join(\", \")}\n              </span>\n              <span style={{ fontSize: \"10px\", color: \"#4caf50\", textAlign: \"center\", marginTop: \"4px\" }}>\n                ðŸ’¡ Arrastra mÃ¡s archivos aquÃ­ o usa el botÃ³n verde\n              </span>\n            </div>\n          )}\n          \n          <IconButton\n            aria-label=\"send-upload\"\n            component=\"span\"\n            onClick={handleUploadMedia}\n            disabled={loading}\n          >\n            <SendIcon className={classes.sendMessageIcons} />\n          </IconButton>\n        </div>\n      </Paper>\n    );\n  else {\n    return (\n      <Paper square elevation={0} className={classes.mainWrapper}>\n        {replyingMessage && renderReplyingMessage(replyingMessage)}\n        <div \n          className={classes.newMessageBox}\n          onDragOver={handleDragOver}\n          onDragEnter={handleDragEnter}\n          onDragLeave={handleDragLeave}\n          onDrop={handleDrop}\n          style={{\n            border: isDragOver ? \"2px dashed #2196f3\" : \"none\",\n            backgroundColor: isDragOver ? \"#f0f8ff\" : \"transparent\",\n            transition: \"all 0.3s ease\",\n            position: \"relative\"\n          }}\n        >\n          {/* Indicador de drag & drop */}\n          {isDragOver && (\n            <div style={{\n              position: \"absolute\",\n              top: \"50%\",\n              left: \"50%\",\n              transform: \"translate(-50%, -50%)\",\n              background: \"rgba(33, 150, 243, 0.9)\",\n              color: \"white\",\n              padding: \"20px\",\n              borderRadius: \"10px\",\n              zIndex: 1000,\n              pointerEvents: \"none\",\n              fontSize: \"16px\",\n              fontWeight: \"bold\",\n              boxShadow: \"0 4px 20px rgba(0,0,0,0.3)\"\n            }}>\n              ðŸ“ SUELTA AQUÃ PARA ADJUNTAR ARCHIVOS - NUEVO\n            </div>\n          )}\n          <EmojiOptions\n            disabled={disableOption()}\n            handleAddEmoji={handleAddEmoji}\n            showEmoji={showEmoji}\n            setShowEmoji={setShowEmoji}\n          />\n\n          <FileInput\n            disableOption={disableOption}\n            handleChangeMedias={handleChangeMedias}\n          />\n\n          <IconButton\n            aria-label=\"quickReplies\"\n            component=\"span\"\n            disabled={disableOption()}\n            onClick={handleQuickReplyButtonClick}\n            title=\"Respuestas RÃ¡pidas\"\n          >\n            <FlashOnIcon className={classes.sendMessageIcons} />\n          </IconButton>\n\n          <IconButton\n            aria-label=\"fileLists\"\n            component=\"span\"\n            disabled={disableOption()}\n            onClick={handleFileListButtonClick}\n            title=\"Listas de Archivos\"\n          >\n            <FolderIcon className={classes.sendMessageIcons} />\n          </IconButton>\n\n          <Menu\n            anchorEl={fileListAnchorEl}\n            open={Boolean(fileListAnchorEl)}\n            onClose={handleFileListMenuClose}\n            PaperProps={{\n              style: {\n                maxHeight: 300,\n                width: 300,\n              },\n            }}\n          >\n            {fileListOptions.map((fileList) => (\n              <MenuItem\n                key={fileList.value.id}\n                onClick={() => handleFileListSelect(fileList)}\n                style={{ \n                  display: 'flex', \n                  alignItems: 'center',\n                  fontSize: '14px',\n                  padding: '8px 16px'\n                }}\n              >\n                {fileList.label}\n              </MenuItem>\n            ))}\n            {fileListOptions.length === 0 && (\n              <MenuItem disabled>\n                No hay listas de archivos disponibles\n              </MenuItem>\n            )}\n          </Menu>\n\n          <SignSwitch\n            width={props.width}\n            setSignMessage={setSignMessage}\n            signMessage={signMessage}\n          />\n\n          <CustomInput\n            loading={loading}\n            inputRef={inputRef}\n            ticketStatus={ticketStatus}\n            inputMessage={inputMessage}\n            setInputMessage={setInputMessage}\n            // handleChangeInput={handleChangeInput}\n            handleSendMessage={handleSendMessage}\n            handleInputPaste={handleInputPaste}\n            disableOption={disableOption}\n            replyingMessage={replyingMessage}\n            handleQuickAnswersClick={handleQuickAnswersClick}\n            options={options}\n            popupOpen={popupOpen}\n          />\n\n          <ActionButtons\n            inputMessage={inputMessage}\n            loading={loading}\n            recording={recording}\n            ticketStatus={ticketStatus}\n            handleSendMessage={handleSendMessage}\n            handleCancelAudio={handleCancelAudio}\n            handleUploadAudio={handleUploadAudio}\n            handleStartRecording={handleStartRecording}\n            handleOpenModalForward={handleOpenModalForward}\n            showSelectMessageCheckbox={showSelectMessageCheckbox}\n            setShowSelectMessageCheckbox={setShowSelectMessageCheckbox}\n            setSelectedMessages={setSelectedMessages}\n          />\n        </div>\n      </Paper>\n    );\n  }\n};\n\nexport default withWidth()(MessageInputCustom);\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}
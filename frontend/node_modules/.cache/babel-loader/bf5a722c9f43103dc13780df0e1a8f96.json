{"ast":null,"code":"import React,{useState,useContext,useEffect}from\"react\";import clsx from\"clsx\";import{makeStyles,Drawer,AppBar,Toolbar,List,Typography,Divider,MenuItem,IconButton,Menu,useTheme,useMediaQuery}from\"@material-ui/core\";import MenuIcon from\"@material-ui/icons/Menu\";import ChevronLeftIcon from\"@material-ui/icons/ChevronLeft\";import AccountCircle from\"@material-ui/icons/AccountCircle\";import CachedIcon from\"@material-ui/icons/Cached\";import MainListItems from\"./MainListItems\";import NotificationsPopOver from\"../components/NotificationsPopOver\";import NotificationsVolume from\"../components/NotificationsVolume\";import UserModal from\"../components/UserModal\";import{AuthContext}from\"../context/Auth/AuthContext\";import BackdropLoading from\"../components/BackdropLoading\";import{i18n}from\"../translate/i18n\";import toastError from\"../errors/toastError\";import AnnouncementsPopover from\"../components/AnnouncementsPopover\";//import logo from \"../assets/logo.png\";\nimport{SocketContext}from\"../context/Socket/SocketContext\";import ChatPopover from\"../pages/Chat/ChatPopover\";import{useDate}from\"../hooks/useDate\";import ColorModeContext from\"../layout/themeContext\";import Brightness4Icon from'@material-ui/icons/Brightness4';import Brightness7Icon from'@material-ui/icons/Brightness7';import LoggerConfig from\"../components/LoggerConfig\";import SettingsIcon from'@material-ui/icons/Settings';const drawerWidth=240;const useStyles=makeStyles(theme=>({root:{display:\"flex\",height:\"100vh\",[theme.breakpoints.down(\"sm\")]:{height:\"calc(100vh - 56px)\"},backgroundColor:theme.palette.fancyBackground,'& .MuiButton-outlinedPrimary':{color:theme.mode==='light'?'#FFF':'#FFF',backgroundColor:theme.mode==='light'?'#1e3a8a':'#1f2937'//border: theme.mode === 'light' ? '1px solid rgba(0 124 102)' : '1px solid rgba(255, 255, 255, 0.5)',\n},'& .MuiTab-textColorPrimary.Mui-selected':{color:theme.mode==='light'?'#1e3a8a':'#FFF'}},avatar:{width:\"100%\"},toolbar:{paddingRight:24,// keep right padding when drawer closed\ncolor:theme.palette.dark.main,background:theme.palette.barraSuperior},toolbarIcon:{display:\"flex\",alignItems:\"center\",justifyContent:\"space-between\",padding:\"0 8px\",minHeight:\"48px\",[theme.breakpoints.down(\"sm\")]:{height:\"48px\"}},appBar:{zIndex:theme.zIndex.drawer+1,transition:theme.transitions.create([\"width\",\"margin\"],{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.leavingScreen})},appBarShift:{marginLeft:drawerWidth,width:`calc(100% - ${drawerWidth}px)`,transition:theme.transitions.create([\"width\",\"margin\"],{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.enteringScreen}),[theme.breakpoints.down(\"sm\")]:{display:\"none\"}},menuButton:{marginRight:36},menuButtonHidden:{display:\"none\"},title:{flexGrow:1,fontSize:14,color:\"white\"},drawerPaper:{position:\"relative\",whiteSpace:\"nowrap\",width:drawerWidth,transition:theme.transitions.create(\"width\",{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.enteringScreen}),[theme.breakpoints.down(\"sm\")]:{width:\"100%\"},...theme.scrollbarStylesSoft},drawerPaperClose:{overflowX:\"hidden\",transition:theme.transitions.create(\"width\",{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.leavingScreen}),width:theme.spacing(7),[theme.breakpoints.up(\"sm\")]:{width:theme.spacing(9)},[theme.breakpoints.down(\"sm\")]:{width:\"100%\"}},appBarSpacer:{minHeight:\"48px\"},content:{flex:1,overflow:\"auto\"},container:{paddingTop:theme.spacing(4),paddingBottom:theme.spacing(4)},paper:{padding:theme.spacing(2),display:\"flex\",overflow:\"auto\",flexDirection:\"column\"},containerWithScroll:{flex:1,padding:theme.spacing(1),overflowY:\"scroll\",...theme.scrollbarStyles},NotificationsPopOver:{// color: theme.barraSuperior.secondary.main,\n},logo:{width:\"80%\",height:\"auto\",maxWidth:180,[theme.breakpoints.down(\"sm\")]:{width:\"auto\",height:\"80%\",maxWidth:180},logo:theme.logo}}));const LoggedInLayout=_ref=>{var _user$company,_user$company2,_user$company3,_user$company4;let{children,themeToggle}=_ref;const classes=useStyles();const[userModalOpen,setUserModalOpen]=useState(false);const[anchorEl,setAnchorEl]=useState(null);const[menuOpen,setMenuOpen]=useState(false);const[loggerConfigOpen,setLoggerConfigOpen]=useState(false);const{loading}=useContext(AuthContext);const[drawerOpen,setDrawerOpen]=useState(false);const[drawerVariant,setDrawerVariant]=useState(\"permanent\");// const [dueDate, setDueDate] = useState(\"\");\nconst{user}=useContext(AuthContext);const theme=useTheme();const{colorMode}=useContext(ColorModeContext);const greaterThenSm=useMediaQuery(theme.breakpoints.up(\"sm\"));const[volume,setVolume]=useState(localStorage.getItem(\"volume\")||1);const{dateToClient}=useDate();//################### CODIGOS DE TESTE #########################################\n// useEffect(() => {\n//   navigator.getBattery().then((battery) => {\n//     console.log(`Battery Charging: ${battery.charging}`);\n//     console.log(`Battery Level: ${battery.level * 100}%`);\n//     console.log(`Charging Time: ${battery.chargingTime}`);\n//     console.log(`Discharging Time: ${battery.dischargingTime}`);\n//   })\n// }, []);\n// useEffect(() => {\n//   const geoLocation = navigator.geolocation\n//   geoLocation.getCurrentPosition((position) => {\n//     let lat = position.coords.latitude;\n//     let long = position.coords.longitude;\n//     console.log('latitude: ', lat)\n//     console.log('longitude: ', long)\n//   })\n// }, []);\n// useEffect(() => {\n//   const nucleos = window.navigator.hardwareConcurrency;\n//   console.log('Nucleos: ', nucleos)\n// }, []);\n// useEffect(() => {\n//   console.log('userAgent', navigator.userAgent)\n//   if (\n//     navigator.userAgent.match(/Android/i)\n//     || navigator.userAgent.match(/webOS/i)\n//     || navigator.userAgent.match(/iPhone/i)\n//     || navigator.userAgent.match(/iPad/i)\n//     || navigator.userAgent.match(/iPod/i)\n//     || navigator.userAgent.match(/BlackBerry/i)\n//     || navigator.userAgent.match(/Windows Phone/i)\n//   ) {\n//     console.log('é mobile ', true) //celular\n//   }\n//   else {\n//     console.log('não é mobile: ', false) //nao é celular\n//   }\n// }, []);\n//##############################################################################\nconst socketManager=useContext(SocketContext);useEffect(()=>{if(document.body.offsetWidth>1200){setDrawerOpen(true);}},[]);useEffect(()=>{if(document.body.offsetWidth<600){setDrawerVariant(\"temporary\");}else{setDrawerVariant(\"permanent\");}},[drawerOpen]);useEffect(()=>{const companyId=localStorage.getItem(\"companyId\");const userId=localStorage.getItem(\"userId\");const socket=socketManager.getSocket(companyId);socket.on(`company-${companyId}-auth`,data=>{if(data.user.id===+userId){toastError(\"Sua conta foi acessada em outro computador.\");setTimeout(()=>{localStorage.clear();window.location.reload();},1000);}});socket.emit(\"userStatus\");const interval=setInterval(()=>{socket.emit(\"userStatus\");},1000*60*5);return()=>{socket.disconnect();clearInterval(interval);};},[socketManager]);const handleMenu=event=>{setAnchorEl(event.currentTarget);setMenuOpen(true);};const handleCloseMenu=()=>{setAnchorEl(null);setMenuOpen(false);};const handleOpenUserModal=()=>{setUserModalOpen(true);handleCloseMenu();};const drawerClose=()=>{if(document.body.offsetWidth<600){setDrawerOpen(false);}};const handleRefreshPage=()=>{window.location.reload(false);};const toggleColorMode=()=>{colorMode.toggleColorMode();};if(loading){return/*#__PURE__*/React.createElement(BackdropLoading,null);}const logo=`${process.env.REACT_APP_BACKEND_URL||'http://127.0.0.1:8080'}/public/logotipos/interno.png`;const randomValue=Math.random();// Generate a random number\nconst logoWithRandom=`${logo}?r=${randomValue}`;return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(Drawer,{variant:drawerVariant,className:drawerOpen?classes.drawerPaper:classes.drawerPaperClose,classes:{paper:clsx(classes.drawerPaper,!drawerOpen&&classes.drawerPaperClose)},open:drawerOpen},/*#__PURE__*/React.createElement(\"div\",{className:classes.toolbarIcon},/*#__PURE__*/React.createElement(\"img\",{src:logoWithRandom,style:{margin:\"0 auto\",width:\"50%\"},alt:`${process.env.REACT_APP_NAME_SYSTEM}`}),/*#__PURE__*/React.createElement(IconButton,{onClick:()=>setDrawerOpen(!drawerOpen)},/*#__PURE__*/React.createElement(ChevronLeftIcon,null))),/*#__PURE__*/React.createElement(Divider,null),/*#__PURE__*/React.createElement(List,{className:classes.containerWithScroll},/*#__PURE__*/React.createElement(MainListItems,{drawerClose:drawerClose,collapsed:!drawerOpen})),/*#__PURE__*/React.createElement(Divider,null)),/*#__PURE__*/React.createElement(UserModal,{open:userModalOpen,onClose:()=>setUserModalOpen(false),userId:user===null||user===void 0?void 0:user.id}),/*#__PURE__*/React.createElement(LoggerConfig,{open:loggerConfigOpen,onClose:()=>setLoggerConfigOpen(false)}),/*#__PURE__*/React.createElement(AppBar,{position:\"absolute\",className:clsx(classes.appBar,drawerOpen&&classes.appBarShift),color:\"primary\"},/*#__PURE__*/React.createElement(Toolbar,{variant:\"dense\",className:classes.toolbar},/*#__PURE__*/React.createElement(IconButton,{edge:\"start\",variant:\"contained\",\"aria-label\":\"open drawer\",onClick:()=>setDrawerOpen(!drawerOpen),className:clsx(classes.menuButton,drawerOpen&&classes.menuButtonHidden)},/*#__PURE__*/React.createElement(MenuIcon,null)),/*#__PURE__*/React.createElement(Typography,{component:\"h2\",variant:\"h6\",color:\"inherit\",noWrap:true,className:classes.title},greaterThenSm&&(user===null||user===void 0?void 0:user.profile)===\"admin\"&&(user===null||user===void 0?void 0:(_user$company=user.company)===null||_user$company===void 0?void 0:_user$company.dueDate)?/*#__PURE__*/React.createElement(React.Fragment,null,\"\\xA1Hola \",/*#__PURE__*/React.createElement(\"b\",null,user.name),\", Bienvenido a \",/*#__PURE__*/React.createElement(\"b\",null,user===null||user===void 0?void 0:(_user$company2=user.company)===null||_user$company2===void 0?void 0:_user$company2.name),\"! (Activo hasta \",dateToClient(user===null||user===void 0?void 0:(_user$company3=user.company)===null||_user$company3===void 0?void 0:_user$company3.dueDate),\")\"):/*#__PURE__*/React.createElement(React.Fragment,null,\"\\xA1Hola \",/*#__PURE__*/React.createElement(\"b\",null,user.name),\", Bienvenido a \",/*#__PURE__*/React.createElement(\"b\",null,user===null||user===void 0?void 0:(_user$company4=user.company)===null||_user$company4===void 0?void 0:_user$company4.name),\"!\")),/*#__PURE__*/React.createElement(IconButton,{edge:\"start\",onClick:toggleColorMode},theme.mode==='dark'?/*#__PURE__*/React.createElement(Brightness7Icon,{style:{color:\"white\"}}):/*#__PURE__*/React.createElement(Brightness4Icon,{style:{color:\"white\"}})),/*#__PURE__*/React.createElement(NotificationsVolume,{setVolume:setVolume,volume:volume}),/*#__PURE__*/React.createElement(IconButton,{onClick:handleRefreshPage,\"aria-label\":i18n.t(\"mainDrawer.appBar.refresh\"),color:\"inherit\"},/*#__PURE__*/React.createElement(CachedIcon,{style:{color:\"white\"}})),/*#__PURE__*/React.createElement(IconButton,{onClick:()=>setLoggerConfigOpen(true),\"aria-label\":\"Configuraci\\xF3n de Logs\",color:\"inherit\",title:\"Configuraci\\xF3n de Logs\"},/*#__PURE__*/React.createElement(SettingsIcon,{style:{color:\"white\"}})),user.id&&/*#__PURE__*/React.createElement(NotificationsPopOver,{volume:volume}),/*#__PURE__*/React.createElement(AnnouncementsPopover,null),/*#__PURE__*/React.createElement(ChatPopover,null),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"account of current user\",\"aria-controls\":\"menu-appbar\",\"aria-haspopup\":\"true\",onClick:handleMenu,variant:\"contained\",style:{color:\"white\"}},/*#__PURE__*/React.createElement(AccountCircle,null)),/*#__PURE__*/React.createElement(Menu,{id:\"menu-appbar\",anchorEl:anchorEl,getContentAnchorEl:null,anchorOrigin:{vertical:\"bottom\",horizontal:\"right\"},transformOrigin:{vertical:\"top\",horizontal:\"right\"},open:menuOpen,onClose:handleCloseMenu},/*#__PURE__*/React.createElement(MenuItem,{onClick:handleOpenUserModal},i18n.t(\"mainDrawer.appBar.user.profile\")))))),/*#__PURE__*/React.createElement(\"main\",{className:classes.content},/*#__PURE__*/React.createElement(\"div\",{className:classes.appBarSpacer}),children?children:null));};export default LoggedInLayout;","map":null,"metadata":{},"sourceType":"module"}
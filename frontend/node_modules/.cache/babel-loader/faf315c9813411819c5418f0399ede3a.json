{"ast":null,"code":"import React,{useState,useEffect,useContext,useCallback}from\"react\";import{toast}from\"react-toastify\";import{makeStyles}from\"@material-ui/core/styles\";import Paper from\"@material-ui/core/Paper\";import Button from\"@material-ui/core/Button\";import Table from\"@material-ui/core/Table\";import TableBody from\"@material-ui/core/TableBody\";import TableCell from\"@material-ui/core/TableCell\";import TableHead from\"@material-ui/core/TableHead\";import TableRow from\"@material-ui/core/TableRow\";import IconButton from\"@material-ui/core/IconButton\";import DeleteOutlineIcon from\"@material-ui/icons/DeleteOutline\";import MainContainer from\"../../components/MainContainer\";import MainHeader from\"../../components/MainHeader\";import Title from\"../../components/Title\";import api from\"../../services/api\";import TableRowSkeleton from\"../../components/TableRowSkeleton\";import HubNotificaMeDialog from\"../../components/HubNotificaMeDialog\";import ConfirmationModal from\"../../components/ConfirmationModal\";import toastError from\"../../errors/toastError\";import{Grid}from\"@material-ui/core\";import{AuthContext}from\"../../context/Auth/AuthContext\";// Íconos de Meta\nimport{TbMessageChatbot,TbBrandInstagram,TbBrandFacebook}from\"react-icons/tb\";const useStyles=makeStyles(theme=>({mainPaper:{flex:1,padding:theme.spacing(1),overflowY:\"scroll\",...theme.scrollbarStyles}}));const HubNotificaMe=()=>{const classes=useStyles();const[loading,setLoading]=useState(false);const[HubNotificaMe,setHubNotificaMe]=useState([]);const[selectedHubNotificaMe,setSelectedHubNotificaMe]=useState(null);const[HubNotificaMeModalOpen,setHubNotificaMeDialogOpen]=useState(false);const[confirmModalOpen,setConfirmModalOpen]=useState(false);const[deletingHubNotificaMe,setDeletingHubNotificaMe]=useState(null);const{user}=useContext(AuthContext);// Buscar lista de conexiones NotificaMe\nconst fetchHubNotificaMe=useCallback(async()=>{try{const companyId=localStorage.getItem(\"companyId\");const{data}=await api.get(\"/hub-notificame/list\",{params:{companyId,userId:user.id}});setHubNotificaMe(data);setLoading(false);}catch(err){toastError(err);}},[user.id]);useEffect(()=>{fetchHubNotificaMe();},[fetchHubNotificaMe]);const handleOpenHubNotificaMeDialog=()=>{setSelectedHubNotificaMe(null);setHubNotificaMeDialogOpen(true);};const handleCloseHubNotificaMeDialog=()=>{setSelectedHubNotificaMe(null);setHubNotificaMeDialogOpen(false);fetchHubNotificaMe();};const handleDeleteHubNotificaMe=async HubNotificaMeId=>{try{await api.delete(`/hub-notificame/${HubNotificaMeId}`);toast.success(\"¡Token eliminado correctamente!\");fetchHubNotificaMe();}catch(err){toastError(err);}setDeletingHubNotificaMe(null);};const handleDeleteClick=HubNotificaMe=>{setDeletingHubNotificaMe(HubNotificaMe);setConfirmModalOpen(true);};return/*#__PURE__*/React.createElement(MainContainer,null,/*#__PURE__*/React.createElement(ConfirmationModal,{title:deletingHubNotificaMe&&`¿Eliminar token ${deletingHubNotificaMe.token}?`,open:confirmModalOpen,onClose:()=>{setConfirmModalOpen(false);setDeletingHubNotificaMe(null);},onConfirm:()=>handleDeleteHubNotificaMe(deletingHubNotificaMe.id)},\"\\xBFEst\\xE1s seguro de que quieres eliminar este token?\"),/*#__PURE__*/React.createElement(HubNotificaMeDialog,{open:HubNotificaMeModalOpen,onClose:handleCloseHubNotificaMeDialog,hubnotificameId:selectedHubNotificaMe===null||selectedHubNotificaMe===void 0?void 0:selectedHubNotificaMe.id}),/*#__PURE__*/React.createElement(MainHeader,null,/*#__PURE__*/React.createElement(Grid,{container:true},/*#__PURE__*/React.createElement(Grid,{xs:8,item:true},/*#__PURE__*/React.createElement(Title,null,\"Conexiones Meta\")),/*#__PURE__*/React.createElement(Grid,{xs:4,item:true},/*#__PURE__*/React.createElement(Button,{variant:\"contained\",onClick:handleOpenHubNotificaMeDialog,color:\"primary\"},\"Agregar\")))),/*#__PURE__*/React.createElement(Paper,{className:classes.mainPaper,variant:\"outlined\"},/*#__PURE__*/React.createElement(Table,{size:\"small\"},/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"Nombre del Canal\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"Token del Canal - NotificaMe\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"Canal\"),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},\"Acciones\"))),/*#__PURE__*/React.createElement(TableBody,null,HubNotificaMe.map(HubNotificaMe=>/*#__PURE__*/React.createElement(TableRow,{key:HubNotificaMe.id},/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},HubNotificaMe.nome),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},HubNotificaMe.token),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},HubNotificaMe.tipo===\"Facebook\"?/*#__PURE__*/React.createElement(TbBrandFacebook,{size:32}):HubNotificaMe.tipo===\"Instagram\"?/*#__PURE__*/React.createElement(TbBrandInstagram,{size:32}):HubNotificaMe.tipo===\"Webchat\"?/*#__PURE__*/React.createElement(TbMessageChatbot,{size:32}):HubNotificaMe.tipo),/*#__PURE__*/React.createElement(TableCell,{align:\"center\"},/*#__PURE__*/React.createElement(IconButton,{size:\"small\",onClick:()=>handleDeleteClick(HubNotificaMe)},/*#__PURE__*/React.createElement(DeleteOutlineIcon,null))))),loading&&/*#__PURE__*/React.createElement(TableRowSkeleton,{columns:3})))));};export default HubNotificaMe;","map":null,"metadata":{},"sourceType":"module"}
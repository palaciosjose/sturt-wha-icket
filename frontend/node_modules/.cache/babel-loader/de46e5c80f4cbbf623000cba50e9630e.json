{"ast":null,"code":"import React,{useContext,useState}from\"react\";import{useHistory}from\"react-router-dom\";import{makeStyles,createTheme,ThemeProvider}from\"@material-ui/core/styles\";import{IconButton}from\"@material-ui/core\";import{MoreVert,Replay}from\"@material-ui/icons\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import TicketOptionsMenu from\"../TicketOptionsMenu\";import ButtonWithSpinner from\"../ButtonWithSpinner\";import toastError from\"../../errors/toastError\";import{AuthContext}from\"../../context/Auth/AuthContext\";import{TicketsContext}from\"../../context/Tickets/TicketsContext\";import CheckCircleIcon from'@material-ui/icons/CheckCircle';import UndoRoundedIcon from'@material-ui/icons/UndoRounded';import Tooltip from'@material-ui/core/Tooltip';import{green}from'@material-ui/core/colors';const useStyles=makeStyles(theme=>({actionButtons:{marginRight:6,flex:\"none\",alignSelf:\"center\",marginLeft:\"auto\",\"& > *\":{margin:theme.spacing(0.5)}}}));const TicketActionButtonsCustom=_ref=>{let{ticket}=_ref;const classes=useStyles();const history=useHistory();const[anchorEl,setAnchorEl]=useState(null);const[loading,setLoading]=useState(false);const ticketOptionsMenuOpen=Boolean(anchorEl);const{user}=useContext(AuthContext);const{setCurrentTicket}=useContext(TicketsContext);const customTheme=createTheme({palette:{primary:green}});const handleOpenTicketOptionsMenu=e=>{setAnchorEl(e.currentTarget);};const handleCloseTicketOptionsMenu=e=>{setAnchorEl(null);};const handleUpdateTicketStatus=async(e,status,userId)=>{setLoading(true);try{await api.put(`/tickets/${ticket.id}`,{status:status,userId:userId||null,useIntegration:status===\"closed\"?false:ticket.useIntegration,promptId:status===\"closed\"?false:ticket.promptId,integrationId:status===\"closed\"?false:ticket.integrationId});setLoading(false);if(status===\"open\"){setCurrentTicket({...ticket,code:\"#open\"});}else{setCurrentTicket({id:null,code:null});history.push(\"/tickets\");}}catch(err){setLoading(false);toastError(err);}};return/*#__PURE__*/React.createElement(\"div\",{className:classes.actionButtons},ticket.status===\"closed\"&&/*#__PURE__*/React.createElement(ButtonWithSpinner,{loading:loading,startIcon:/*#__PURE__*/React.createElement(Replay,null),size:\"small\",onClick:e=>handleUpdateTicketStatus(e,\"open\",user===null||user===void 0?void 0:user.id)},i18n.t(\"messagesList.header.buttons.reopen\")),ticket.status===\"open\"&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Tooltip,{title:i18n.t(\"messagesList.header.buttons.return\")},/*#__PURE__*/React.createElement(IconButton,{onClick:e=>handleUpdateTicketStatus(e,\"pending\",null)},/*#__PURE__*/React.createElement(UndoRoundedIcon,null))),/*#__PURE__*/React.createElement(ThemeProvider,{theme:customTheme},/*#__PURE__*/React.createElement(Tooltip,{title:i18n.t(\"messagesList.header.buttons.resolve\")},/*#__PURE__*/React.createElement(IconButton,{onClick:e=>handleUpdateTicketStatus(e,\"closed\",user===null||user===void 0?void 0:user.id),color:\"primary\"},/*#__PURE__*/React.createElement(CheckCircleIcon,null)))),/*#__PURE__*/React.createElement(IconButton,{onClick:handleOpenTicketOptionsMenu},/*#__PURE__*/React.createElement(MoreVert,null)),/*#__PURE__*/React.createElement(TicketOptionsMenu,{ticket:ticket,anchorEl:anchorEl,menuOpen:ticketOptionsMenuOpen,handleClose:handleCloseTicketOptionsMenu})),ticket.status===\"pending\"&&/*#__PURE__*/React.createElement(ButtonWithSpinner,{loading:loading,size:\"small\",variant:\"contained\",color:\"primary\",onClick:e=>handleUpdateTicketStatus(e,\"open\",user===null||user===void 0?void 0:user.id)},i18n.t(\"messagesList.header.buttons.accept\")));};export default TicketActionButtonsCustom;","map":null,"metadata":{},"sourceType":"module"}